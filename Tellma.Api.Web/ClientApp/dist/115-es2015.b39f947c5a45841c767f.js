"use strict";(self.webpackChunktellma=self.webpackChunktellma||[]).push([[115],{3115:function(e,t,n){n.r(t),n.d(t,{AdminModule:function(){return Zn}});var i=n(3423),s=n(5686),o=n(7716),r=n(3795),l=n(9790),a=n(8583),c=n(9577);function u(e,t){if(1&e&&(o.TgZ(0,"a",4),o.TgZ(1,"div",5),o._UZ(2,"fa-icon",6),o.qZA(),o.TgZ(3,"div",7),o._uU(4),o.qZA(),o.qZA()),2&e){const e=t.$implicit,n=o.oxw();o.ekj("d-none",!n.canView(e.view)),o.Q6J("routerLink",e.link),o.xp6(2),o.Q6J("icon",e.icon),o.xp6(2),o.hij(" ",e.label()," ")}}let d=(()=>{class e{constructor(e,t){this.workspace=e,this.translate=t,this.mainMenuItems=[{label:()=>this.translate.instant("AdminUsers"),icon:"users",view:"admin-users",link:"../admin-users"},{label:()=>this.translate.instant("IdentityServerUsers"),icon:"shield-alt",view:"identity-server-users",link:"../identity-server-users"},{label:()=>this.translate.instant("IdentityServerClients"),icon:"shield-alt",view:"identity-server-clients",link:"../identity-server-clients"}]}ngOnInit(){}canView(e){return this.workspace.admin.canRead(e)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW),o.Y36(l.sK))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-admin-main-menu"]],decls:7,vars:4,consts:[[1,"container","py-4","px-5"],[1,"t-menu-section"],[1,"t-teal1"],["class","t-menu-item btn m-1",3,"d-none","routerLink",4,"ngFor","ngForOf"],[1,"t-menu-item","btn","m-1",3,"routerLink"],[1,"pt-4","pb-1","t-menu-item-icon"],[3,"icon"],[1,"px-2","t-menu-item-label"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"span"),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.qZA(),o.TgZ(5,"div",2),o.YNc(6,u,5,5,"a",3),o.qZA(),o.qZA()),2&e&&(o.xp6(3),o.Oqu(o.lcZ(4,2,"AdminConsole")),o.xp6(3),o.Q6J("ngForOf",t.mainMenuItems))},directives:[a.sg,i.yS,c.BN],pipes:[l.X$],encapsulation:2}),e})(),m=(()=>{class e{constructor(e){this.router=e}onHome(){this.router.navigate(["admin","console","main-menu"])}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(i.F0))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-admin-page-not-found"]],decls:11,vars:9,consts:[[1,"p-5"],[1,"text-danger"],[1,"text-muted"],[1,"mt-4"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"h2",1),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"p",2),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.TgZ(7,"div",3),o.TgZ(8,"button",4),o.NdJ("click",function(){return t.onHome()}),o._uU(9),o.ALo(10,"translate"),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(2),o.hij(" ",o.lcZ(3,3,"Error_PageNotFound")," "),o.xp6(3),o.Oqu(o.lcZ(6,5,"Error_PageNotFoundMessage")),o.xp6(4),o.Oqu(o.lcZ(10,7,"Home")))},pipes:[l.X$],encapsulation:2}),e})();var p=n(9765),g=n(5917),h=n(3190),f=n(8307),A=n(5304),w=n(4686),v=n(7554),Z=n(3909),x=n(6854),b=n(1117),M=n(5681),y=n(1408),C=n(8126),q=n(4104),U=n(1181),I=n(3645),S=n(5349),T=n(4577),_=n(3679),N=n(8482),E=n(1887);const J=["myAccountModal"];function O(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",21),o.NdJ("click",function(){o.CHM(e);const t=o.oxw();return t.onCollapse(),t.nav.onBack()}),o._UZ(1,"fa-icon",22),o.qZA()}if(2&e){const e=o.oxw();o.Q6J("disabled",!e.nav.canBack),o.xp6(1),o.Q6J("flip",e.flip)}}function k(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",21),o.NdJ("click",function(){o.CHM(e);const t=o.oxw();return t.onCollapse(),t.nav.onForward()}),o._UZ(1,"fa-icon",23),o.qZA()}if(2&e){const e=o.oxw();o.Q6J("disabled",!e.nav.canForward),o.xp6(1),o.Q6J("flip",e.flip)}}function L(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",17),o.NdJ("click",function(){o.CHM(e);const t=o.oxw().$implicit,n=o.oxw();return n.onSetLanguage(t),n.onCollapse()}),o._uU(1),o.qZA()}if(2&e){const e=o.oxw().$implicit,t=o.oxw();o.xp6(1),o.hij(" ",t.languageName(e)," ")}}function D(e,t){if(1&e&&(o.ynx(0),o.YNc(1,L,2,1,"button",24),o.BQk()),2&e){const e=t.$implicit,n=o.oxw();o.xp6(1),o.Q6J("ngIf",e!==n.currentLanguage)}}const Q=function(){return{updateOn:"blur"}};function Y(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",38),o.TgZ(1,"t-form-group",39),o.TgZ(2,"h2",40),o._uU(3),o.qZA(),o.qZA(),o.TgZ(4,"t-form-group",41),o.ALo(5,"translate"),o.TgZ(6,"t-text-editor",42),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw(2).myUser.Name=t}),o.qZA(),o.qZA(),o.qZA()}if(2&e){const e=o.oxw(2);o.xp6(3),o.Oqu(e.myEmail),o.xp6(1),o.Q6J("label",o.lcZ(5,5,"Name"))("serverErrors",null==e.myUser||null==e.myUser.serverErrors?null:e.myUser.serverErrors.Name),o.xp6(2),o.Q6J("ngModel",e.myUser.Name)("ngModelOptions",o.DdM(7,Q))}}function P(e,t){if(1&e&&(o.TgZ(0,"t-error-message"),o._uU(1),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.hij(" ",e.saveErrorMessage," ")}}function F(e,t){if(1&e&&(o.TgZ(0,"t-error-message"),o._uU(1),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.hij(" ",e.errorMessage," ")}}function j(e,t){1&e&&(o.TgZ(0,"div",43),o._UZ(1,"t-spinner",44),o.qZA()),2&e&&(o.xp6(1),o.Q6J("scale",2))}function H(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",25),o.TgZ(1,"h5",26),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"button",27),o.NdJ("click",function(){return o.CHM(e).$implicit.dismiss(!1)}),o.TgZ(5,"span",28),o._uU(6,"\xd7"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(7,"div",29),o.YNc(8,Y,7,8,"div",30),o.YNc(9,P,2,1,"t-error-message",31),o.YNc(10,F,2,1,"t-error-message",31),o.YNc(11,j,2,1,"div",32),o.qZA(),o.TgZ(12,"div",33),o.TgZ(13,"button",34),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw().onSave(t)}),o._UZ(14,"fa-icon",35),o._uU(15),o.ALo(16,"translate"),o.qZA(),o.TgZ(17,"button",36),o.NdJ("click",function(){return o.CHM(e).$implicit.close(!1)}),o._UZ(18,"fa-icon",37),o._uU(19),o.ALo(20,"translate"),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(2),o.hij(" ",o.lcZ(3,8,"MyAdminAccount")," "),o.xp6(6),o.Q6J("ngIf",e.isMyUserLoaded),o.xp6(1),o.Q6J("ngIf",e.isMyUserLoaded&&!!e.saveErrorMessage),o.xp6(1),o.Q6J("ngIf",e.isMyUserError),o.xp6(1),o.Q6J("ngIf",e.isMyUserLoading),o.xp6(2),o.Q6J("disabled",!e.canSave),o.xp6(2),o.hij(" \xa0",o.lcZ(16,10,"Save")," "),o.xp6(4),o.hij(" \xa0",o.lcZ(20,12,"Cancel")," ")}}const W=function(e){return{placeholder:e}};let R=(()=>{class e{constructor(e,t,n,i,s,o,r,l,a){this.workspace=e,this.nav=t,this.translate=n,this.progress=i,this.auth=s,this.storage=o,this.apiService=r,this.document=l,this.modalService=a,this.isCollapsed=!0,this.notifyDestruct$=new p.xQ,this.adminUsersApi=this.apiService.adminUsersApi(this.notifyDestruct$),this.notifyFetch$=new p.xQ,this.notifyFetch$.pipe((0,h.w)(()=>this.doFetch())).subscribe()}ngOnInit(){this.adminUsersApi=this.apiService.adminUsersApi(this.notifyDestruct$)}ngOnDestroy(){this.notifyDestruct$.next(),this._subscription&&this._subscription.unsubscribe()}get activeLanguages(){return this._activeLanguages||(this._activeLanguages=Object.keys(x.f)),this._activeLanguages}languageName(e){return x.f[e]}onSetLanguage(e){this.translate.use(e),this.storage.setItem("user_culture",e)}get currentLanguage(){return this.workspace.ws.culture||this.translate.currentLang||this.translate.defaultLang||"en"}onToggleCollapse(){this.isCollapsed=!this.isCollapsed}onCollapse(){this.isCollapsed=!0}get settings(){return this.ws?this.ws.settings:null}get ws(){return this.workspace.admin}get userName(){return this.ws.userSettings.Name}get isRtl(){return this.workspace.ws.isRtl}onMySystemAccount(){location.href=w.hG.identityAddress+"/identity/manage/"}onSignOut(){this.progress.startAsyncOperation("sign_out","RedirectingToSignOut"),this.auth.signOut()}get flip(){return this.isRtl?"horizontal":null}onMyAdminAccount(){this.fetch(),this.workspace.ignoreKeyDownEvents=!0,this.modalService.open(this.myAccountModal,{windowClass:"t-myuser-modal"}).result.then(()=>this.onMyAdminAccountClose(),()=>this.onMyAdminAccountClose())}onMyAdminAccountClose(){this.workspace.ignoreKeyDownEvents=!1}fetch(){this.notifyFetch$.next(null)}doFetch(){return this.myUserStatus=r.Ov.loading,this.adminUsersApi.getMyUser().pipe((0,f.b)(e=>{(0,v.lH)(e,this.workspace),this.myUserStatus=r.Ov.loaded,this.onEdit()}),(0,A.K)(e=>(this._errorMessage=e.error,this.myUserStatus=r.Ov.error,(0,g.of)(null))))}onEdit(){const e=this.ws.get("AdminUser",this.ws.userSettings.UserId);this.myUser={Name:e.Name}}onSave(e){this._errorMessage=null,this._saveErrorMessage=null,(0,Z.bU)(this.myUser),this.adminUsersApi.saveMyUser(this.myUser).subscribe(t=>{(0,v.lH)(t,this.workspace),e.close(!0)},e=>{if(422===e.status){const t=(0,Z.zn)(this.myUser,e.error);Object.keys(t).length>0&&console.error(t)}else this._saveErrorMessage=e.error;return(0,g.of)(null)})}get errorMessage(){return this._errorMessage}get saveErrorMessage(){return this._saveErrorMessage}get isMyUserLoaded(){return this.myUserStatus===r.Ov.loaded}get isMyUserError(){return this.myUserStatus===r.Ov.error}get isMyUserLoading(){return this.myUserStatus===r.Ov.loading}get myEmail(){return this.ws.get("AdminUser",this.ws.userSettings.UserId).Email}get canSave(){return this.isMyUserLoaded}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW),o.Y36(b.f),o.Y36(l.sK),o.Y36(M.K),o.Y36(y.e),o.Y36(C.V),o.Y36(q.s),o.Y36(a.K0),o.Y36(U.FF))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-admin-shell"]],viewQuery:function(e,t){if(1&e&&o.Gf(J,7),2&e){let e;o.iGM(e=o.CRH())&&(t.myAccountModal=e.first)}},decls:41,vars:35,consts:[[1,"d-flex","flex-column","h-100"],[1,"navbar","navbar-light","shadow-sm","border-bottom","bg-white","navbar-expand-sm","p-0","align-items-sm-stretch"],["routerLink","main-menu",1,"t-brand-link","t-navbar-button","d-flex","align-items-baseline",3,"title"],["theme","light",3,"scale"],[1,"mx-2","d-flex"],["class","t-navbar-button nav-link",3,"disabled","click",4,"ngIf"],["type","button",1,"navbar-toggler","mx-2",3,"click"],[1,"navbar-toggler-icon"],[1,"collapse","navbar-collapse","align-items-stretch",3,"ngbCollapse"],[1,"nav","navbar-nav","px-4","px-lg-0"],[1,"nav","navbar-nav","p-0"],["ngbDropdown","","container","",1,"nav-item"],["ngbDropdownToggle","",1,"h-100","w-100","d-flex","t-navbar-button","t-no-arrow","align-items-center"],[1,"px-2"],["ngbDropdownMenu","","aria-labelledby","action",1,"dropdown-menu","shadow","m-0"],["type","button","ngbDropdownItem","","routerLink","/root/companies",1,"dropdown-item","btn-light",3,"click"],["type","button","ngbDropdownItem","","routerLink","/root/welcome",1,"dropdown-item","btn-light",3,"click"],["type","button","ngbDropdownItem","",1,"dropdown-item","btn-light",3,"click"],[4,"ngFor","ngForOf"],[1,"t-rest-of-screen","container-fluid"],["myAccountModal",""],[1,"t-navbar-button","nav-link",3,"disabled","click"],["icon","arrow-left",3,"flip"],["icon","arrow-right",3,"flip"],["type","button","class","dropdown-item btn-light","ngbDropdownItem","",3,"click",4,"ngIf"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0","bg-white"],["class","row m-0 px-1 px-sm-3 pt-3 pt-sm-4 pb-3 pb-sm-5",4,"ngIf"],[4,"ngIf"],["class","d-flex justify-content-center py-2",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-primary",3,"disabled","click"],["icon","save"],["ngbAutofocus","",1,"btn","btn-light","text-primary","t-white-button",3,"click"],["icon","times"],[1,"row","m-0","px-1","px-sm-3","pt-3","pt-sm-4","pb-3","pb-sm-5"],[1,"col-12","mb-2","mb-sm-4","t-h2"],[1,"font-weight-normal"],[1,"t-form-group",3,"label","serverErrors"],["required","",3,"ngModel","ngModelOptions","ngModelChange"],[1,"d-flex","justify-content-center","py-2"],[3,"scale"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"nav",1),o.TgZ(2,"a",2),o.ALo(3,"translate"),o._UZ(4,"t-brand",3),o.qZA(),o.TgZ(5,"div",4),o.YNc(6,O,2,2,"button",5),o._uU(7," \xa0 "),o.YNc(8,k,2,2,"button",5),o.qZA(),o.TgZ(9,"button",6),o.NdJ("click",function(){return t.onToggleCollapse()}),o._UZ(10,"span",7),o.qZA(),o.TgZ(11,"div",8),o._UZ(12,"ol",9),o.TgZ(13,"ol",10),o.TgZ(14,"li",11),o.TgZ(15,"button",12),o.TgZ(16,"span",13),o._uU(17),o.qZA(),o.qZA(),o.TgZ(18,"div",14),o.TgZ(19,"button",15),o.NdJ("click",function(){return t.onCollapse()}),o._uU(20),o.ALo(21,"translate"),o.qZA(),o.TgZ(22,"button",16),o.NdJ("click",function(){return t.onCollapse()}),o._uU(23),o.ALo(24,"translate"),o.qZA(),o.TgZ(25,"button",17),o.NdJ("click",function(){return t.onMySystemAccount(),t.onCollapse()}),o._uU(26),o.ALo(27,"translate"),o.ALo(28,"translate"),o.qZA(),o.TgZ(29,"button",17),o.NdJ("click",function(){return t.onMyAdminAccount(),t.onCollapse()}),o._uU(30),o.ALo(31,"translate"),o.qZA(),o.TgZ(32,"button",17),o.NdJ("click",function(){return t.onSignOut(),t.onCollapse()}),o._uU(33),o.ALo(34,"translate"),o.qZA(),o._UZ(35,"hr"),o.YNc(36,D,2,1,"ng-container",18),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(37,"main",19),o._UZ(38,"router-outlet"),o.qZA(),o.qZA(),o.YNc(39,H,21,14,"ng-template",null,20,o.W1O)),2&e&&(o.xp6(2),o.Q6J("title",o.lcZ(3,18,"Home")),o.xp6(2),o.Q6J("scale",1),o.xp6(2),o.Q6J("ngIf",t.nav.showBack),o.xp6(2),o.Q6J("ngIf",t.nav.showForward),o.xp6(3),o.Q6J("ngbCollapse",t.isCollapsed),o.xp6(1),o.ekj("mr-auto",!t.isRtl)("ml-auto",t.isRtl),o.xp6(5),o.Oqu(t.userName),o.xp6(1),o.ekj("dropdown-menu-right",!t.isRtl),o.xp6(2),o.hij(" ",o.lcZ(21,20,"MyCompanies")," "),o.xp6(3),o.hij(" ",o.lcZ(24,22,"WelcomePage")," "),o.xp6(3),o.hij(" ",o.xi3(27,24,"My0Account",o.VKq(33,W,o.lcZ(28,27,"AppName")))," "),o.xp6(4),o.hij(" ",o.lcZ(31,29,"MyAdminAccount")," "),o.xp6(3),o.hij(" ",o.lcZ(34,31,"SignOut")," "),o.xp6(3),o.Q6J("ngForOf",t.activeLanguages))},directives:[U.M2,i.yS,I.Z,a.O5,U._D,U.jt,U.iD,U.Vi,U.TH,i.rH,a.sg,i.lC,c.BN,S.H,T.d,_.Q7,_.JJ,_.On,N.H,E.O],pipes:[l.X$],encapsulation:2}),e})();var V=n(6528),B=n(6063),$=n(2887),K=n(5587),X=n(5076),G=n(5046),z=n(5533);function ee(e,t){if(1&e&&(o.TgZ(0,"div",11),o._UZ(1,"t-auto-cell",12),o.qZA(),o.TgZ(2,"div",13),o._UZ(3,"t-auto-cell",14),o._UZ(4,"t-auto-cell",15),o.qZA()),2&e){const e=t.id,n=o.oxw();o.xp6(1),o.Q6J("entity",n.c[e]),o.xp6(2),o.Q6J("entity",n.c[e]),o.xp6(1),o.Q6J("entity",n.c[e])}}function te(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"AdminUser"),"\n")}function ne(e,t){if(1&e&&o._UZ(0,"t-auto-cell",16),2&e){const e=t.id,n=o.oxw();o.Q6J("entity",n.c[e])}}function ie(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"SendInvitationEmail")," ")}function se(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"Activate")," ")}function oe(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"Deactivate")," ")}function re(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"CreatedByMe")," ")}function le(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"User_New")," ")}function ae(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"User_Invited")," ")}function ce(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"User_Member")," ")}const ue=function(e,t,n,i,s){return{template:e,action:t,canInvite:n,actionTooltip:i,showAction:s}},de=function(e,t,n,i){return{template:e,action:t,canAction:n,actionTooltip:i}},me=function(e,t,n){return[e,t,n]},pe=function(e){return{template:e,expression:"CreatedById eq me"}},ge=function(e){return[e]},he=function(e){return{template:e,expression:"State eq 0"}},fe=function(e){return{template:e,expression:"State eq 1"}},Ae=function(e){return{template:e,expression:"State eq 2"}},we=function(e,t){return{CreatedBy:e,State:t}};let ve=(()=>{class e extends X.W{constructor(e,t,n){super(),this.workspace=e,this.api=t,this.translate=n,this.adminUsersApi=this.api.adminUsersApi(this.notifyDestruct$),this.onActivate=e=>this.adminUsersApi.activate(e,{returnEntities:!0}).pipe((0,f.b)(e=>(0,v.DP)(e,this.workspace))),this.onDeactivate=e=>this.adminUsersApi.deactivate(e,{returnEntities:!0}).pipe((0,f.b)(e=>(0,v.DP)(e,this.workspace))),this.canActivateDeactivateItem=e=>this.ws.canDo("admin-users","IsActive",null),this.activateDeactivateTooltip=e=>this.canActivateDeactivateItem(e)?"":this.translate.instant("Error_AccountDoesNotHaveSufficientPermissions"),this.onInvite=e=>this.adminUsersApi.invite(e,{returnEntities:!0}).pipe((0,f.b)(e=>(0,v.DP)(e,this.workspace))),this.canInvite=e=>this.ws.canDo("admin-users","SendInvitationEmail",null),this.inviteTooltip=e=>this.canActivateDeactivateItem(e)?"":this.translate.instant("Error_AccountDoesNotHaveSufficientPermissions"),this.showInvite=e=>this.workspace.globalSettings.CanInviteUsers,this.adminUsersApi=this.api.adminUsersApi(this.notifyDestruct$)}get c(){return this.ws.AdminUser}get ws(){return this.workspace.admin}filterStateFilters(e){const t=this.workspace.globalSettings;return(this._filterStateFiltersInput!==e||this._globalSettings!==t)&&(this._filterStateFiltersInput=e,t.CanInviteUsers?this._filterStateFiltersResult=e:e?this._filterStateFiltersResult=e.filter(e=>"State eq 1"!==e.expression):delete this._filterStateFiltersResult),this._filterStateFiltersResult}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW),o.Y36(q.s),o.Y36(l.sK))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-admin-users-master"]],features:[o.qOj],decls:22,vars:49,consts:[["collection","AdminUser","selectDefault","Email,State,LastAccess","selectForTiles","State,Email",3,"mode","showCreateButton","filterDefault","additionalSelect","masterCrumb","tileTemplate","tableSummaryColumnTemplate","tableSummaryHeaderTemplate","multiselectActions","filterDefinition"],["tile",""],["summaryHeader",""],["summaryColumn",""],["invite",""],["activate",""],["deactivate",""],["createdByMe",""],["newUser",""],["invited",""],["member",""],[1,"d-flex","justify-content-between"],["collection","AdminUser","path","",3,"entity"],[1,"d-flex","justify-content-between","mt-1","small"],["collection","AdminUser","path","Email",3,"entity"],["collection","AdminUser","path","State",3,"entity"],["collection","AdminUser",3,"entity"]],template:function(e,t){if(1&e&&(o._UZ(0,"t-master",0),o.ALo(1,"translate"),o.YNc(2,ee,5,3,"ng-template",null,1,o.W1O),o.YNc(4,te,2,3,"ng-template",null,2,o.W1O),o.YNc(6,ne,1,1,"ng-template",null,3,o.W1O),o.YNc(8,ie,2,3,"ng-template",null,4,o.W1O),o.YNc(10,se,2,3,"ng-template",null,5,o.W1O),o.YNc(12,oe,2,3,"ng-template",null,6,o.W1O),o.YNc(14,re,2,3,"ng-template",null,7,o.W1O),o.YNc(16,le,2,3,"ng-template",null,8,o.W1O),o.YNc(18,ae,2,3,"ng-template",null,9,o.W1O),o.YNc(20,ce,2,3,"ng-template",null,10,o.W1O)),2&e){const e=o.MAs(3),n=o.MAs(5),i=o.MAs(7),s=o.MAs(9),r=o.MAs(11),l=o.MAs(13),a=o.MAs(15),c=o.MAs(17),u=o.MAs(19),d=o.MAs(21);o.Q6J("mode",t.mode)("showCreateButton",t.showCreate)("filterDefault",t.filter)("additionalSelect",t.additionalSelect)("masterCrumb",o.lcZ(1,10,"AdminUsers"))("tileTemplate",e)("tableSummaryColumnTemplate",i)("tableSummaryHeaderTemplate",n)("multiselectActions",o.kEZ(28,me,o.qbA(12,ue,s,t.onInvite,t.canInvite,t.inviteTooltip,t.showInvite),o.l5B(18,de,r,t.onActivate,t.canActivateDeactivateItem,t.activateDeactivateTooltip),o.l5B(23,de,l,t.onDeactivate,t.canActivateDeactivateItem,t.activateDeactivateTooltip)))("filterDefinition",o.WLB(46,we,o.VKq(34,ge,o.VKq(32,pe,a)),t.filterStateFilters(o.kEZ(42,me,o.VKq(36,he,c),o.VKq(38,fe,u),o.VKq(40,Ae,d)))))}},directives:[G.c,z.q_],pipes:[l.X$],encapsulation:2}),e})();var Ze=n(7234),xe=n(6196),be=n(1851),Me=n(6912),ye=n(7872),Ce=n(7148);function qe(e,t){if(1&e&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&e){const e=t.model;o.xp6(1),o.Oqu(null==e?null:e.Name)}}function Ue(e,t){if(1&e&&(o.TgZ(0,"div"),o.TgZ(1,"span"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.qZA()),2&e){const e=o.oxw().model;o.ekj("active",1===(null==e?null:e.State)),o.xp6(2),o.Oqu(o.lcZ(3,3,"User_Invited"))}}function Ie(e,t){if(1&e&&(o.TgZ(0,"div",7),o.TgZ(1,"t-restricted",8),o.TgZ(2,"div",9),o.TgZ(3,"div"),o.TgZ(4,"span"),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.qZA(),o.YNc(7,Ue,4,5,"div",10),o.TgZ(8,"div"),o.TgZ(9,"span"),o._uU(10),o.ALo(11,"translate"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(12,"div",11),o.TgZ(13,"span"),o._uU(14),o.ALo(15,"translate"),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&e){const e=t.model,n=o.oxw();o.xp6(1),o.Q6J("metadata",null==e||null==e.EntityMetadata?null:e.EntityMetadata.State),o.xp6(2),o.ekj("active",n.isNew||0===(null==e?null:e.State)),o.xp6(2),o.Oqu(o.lcZ(6,9,"User_New")),o.xp6(2),o.Q6J("ngIf",n.showInvitedState(e)),o.xp6(1),o.ekj("active",2===(null==e?null:e.State)),o.xp6(2),o.Oqu(o.lcZ(11,11,"User_Member")),o.xp6(4),o.Oqu(o.lcZ(15,13,2===(null==e?null:e.State)?"User_Member":1===(null==e?null:e.State)?"User_Invited":"User_New"))}}function Se(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",32),o.NdJ("click",function(){o.CHM(e);const t=o.oxw(2).model;return o.oxw().onInvite(t)}),o._uU(1),o.ALo(2,"translate"),o.qZA()}2&e&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"SendInvitationEmail"),""))}const Te=function(e){return{name:e}};function _e(e,t){if(1&e&&(o.TgZ(0,"div",29),o.TgZ(1,"span"),o._UZ(2,"fa-icon",30),o._uU(3),o.ALo(4,"translate"),o.YNc(5,Se,3,3,"button",31),o.qZA(),o.qZA()),2&e){const e=o.oxw().model,t=o.oxw();o.xp6(3),o.hij("\xa0\xa0",o.xi3(4,2,"AdminUserNewNotice",o.VKq(5,Te,null==e?null:e.Name))," \xa0\xa0"),o.xp6(2),o.Q6J("ngIf",t.canInvite(e))}}const Ne=function(e){return{email:e}};function Ee(e,t){if(1&e&&(o.TgZ(0,"div",29),o.TgZ(1,"span"),o._UZ(2,"fa-icon",30),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.qZA()),2&e){const e=o.oxw().model;o.xp6(3),o.hij("\xa0\xa0",o.xi3(4,1,"AdminUserFreshInvitedNotice",o.VKq(4,Ne,null==e?null:e.Email))," ")}}function Je(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",32),o.NdJ("click",function(){o.CHM(e);const t=o.oxw(2).model;return o.oxw().onInvite(t)}),o._uU(1),o.ALo(2,"translate"),o.qZA()}2&e&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"SendInvitationEmail"),""))}function Oe(e,t){if(1&e&&(o.TgZ(0,"div",29),o.TgZ(1,"span"),o._UZ(2,"fa-icon",30),o._uU(3),o.ALo(4,"translate"),o.YNc(5,Je,3,3,"button",31),o.qZA(),o.qZA()),2&e){const e=o.oxw().model,t=o.oxw();o.xp6(3),o.hij("\xa0\xa0",o.xi3(4,2,"AdminUserExpiredInvitedNotice",o.VKq(5,Te,null==e?null:e.Name))," \xa0\xa0"),o.xp6(2),o.Q6J("ngIf",t.canInvite(e))}}function ke(e,t){if(1&e&&(o.TgZ(0,"h2",33),o._uU(1),o.qZA()),2&e){const e=o.oxw().model;o.xp6(1),o.Oqu(null==e?null:e.Name)}}const Le=function(){return{updateOn:"blur"}};function De(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",34),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().model.Name=t}),o.ALo(1,"translate"),o.qZA()}if(2&e){const e=o.oxw().model;o.Q6J("focusIf",!e.Id)("ngModel",e.Name)("ngModelOptions",o.DdM(6,Le))("placeholder",o.lcZ(1,4,"Name"))}}function Qe(e,t){if(1&e&&(o.TgZ(0,"t-restricted",8),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&e){const e=o.oxw().model;o.Q6J("metadata",null==e||null==e.EntityMetadata?null:e.EntityMetadata.IsService),o.xp6(1),o.hij(" ",o.lcZ(2,2,null!=e&&e.IsService?"Yes":"No")," ")}}function Ye(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",35),o.TgZ(1,"input",36),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().model.IsService=t}),o.qZA(),o.TgZ(2,"label",37),o._uU(3,"\u200c"),o.qZA(),o.qZA()}if(2&e){const e=o.oxw().model;o.xp6(1),o.Q6J("ngModel",e.IsService)}}function Pe(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const e=o.oxw(2).model;o.xp6(1),o.Oqu(null==e?null:e.Email)}}function Fe(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",40),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw(2).model.Email=t}),o.qZA()}if(2&e){const e=o.oxw(2).model,t=o.oxw();o.Q6J("ngModel",e.Email)("ngModelOptions",o.DdM(3,Le))("disabled",!t.isNew)}}function je(e,t){if(1&e&&(o.TgZ(0,"t-form-group",16),o.ALo(1,"translate"),o.YNc(2,Pe,2,1,"div",38),o.YNc(3,Fe,1,4,"t-text-editor",39),o.qZA()),2&e){const e=o.oxw(),t=e.model,n=e.isEdit;o.Q6J("label",o.lcZ(1,4,"User_Email"))("serverErrors",null==t||null==t.serverErrors?null:t.serverErrors.Email),o.xp6(2),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n)}}function He(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const e=o.oxw(2).model;o.xp6(1),o.Oqu(null==e?null:e.ClientId)}}function We(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",42),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw(2).model.ClientId=t}),o.qZA()}if(2&e){const e=o.oxw(2).model,t=o.oxw();o.Q6J("ngModel",e.ClientId)("ngModelOptions",o.DdM(3,Le))("disabled",!t.isNew)}}function Re(e,t){if(1&e&&(o.TgZ(0,"t-form-group",16),o.ALo(1,"translate"),o.YNc(2,He,2,1,"div",38),o.YNc(3,We,1,4,"t-text-editor",41),o.qZA()),2&e){const e=o.oxw(),t=e.model,n=e.isEdit;o.Q6J("label",o.lcZ(1,4,"User_ClientId"))("serverErrors",null==t||null==t.serverErrors?null:t.serverErrors.ClientId),o.xp6(2),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n)}}function Ve(e,t){if(1&e&&(o.TgZ(0,"t-form-group",43),o.ALo(1,"translate"),o._UZ(2,"t-auto-cell",44),o.qZA()),2&e){const e=o.oxw().model;o.Q6J("label",o.lcZ(1,2,"User_LastActivity")),o.xp6(2),o.Q6J("entity",e)}}function Be(e,t){if(1&e&&(o.TgZ(0,"t-form-group",43),o.ALo(1,"translate"),o.TgZ(2,"div"),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.qZA()),2&e){const e=o.oxw().model;o.Q6J("label",o.lcZ(1,2,"IsActive")),o.xp6(3),o.Oqu(o.lcZ(4,4,e?e.IsActive?"Yes":"No":""))}}function $e(e,t){1&e&&(o.TgZ(0,"span",45),o._uU(1,"\xa0"),o._UZ(2,"fa-icon",46),o.qZA())}function Ke(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.Oqu(o.lcZ(1,1,"Permission_View"))}function Xe(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const e=o.oxw().item,t=o.oxw(3);o.xp6(1),o.hij(" ",t.permissionViewLookup(e.View)," ")}}function Ge(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-selector",58),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().item.View=t})("ngModelChange",function(){o.CHM(e);const t=o.oxw(),n=t.item,i=t.update,s=o.oxw(3);return i.call(null,n),s.onPermissionChanged(n)}),o.qZA()}if(2&e){const e=o.oxw().item,t=o.oxw(3);o.Q6J("choices",t.permissionViewChoices)("ngModel",e.View)("required",!e.PH)}}function ze(e,t){if(1&e&&(o.TgZ(0,"t-form-group-cell",56),o.YNc(1,Xe,2,1,"div",38),o.YNc(2,Ge,1,3,"t-selector",57),o.qZA()),2&e){const e=t.item,n=o.oxw(2).isEdit;o.Q6J("serverErrors",null==e.serverErrors?null:e.serverErrors.View),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n)}}function et(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.Oqu(o.lcZ(1,1,"Permission_Action"))}function tt(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&e){const e=o.oxw().item,t=o.oxw(3);o.xp6(1),o.Oqu(o.lcZ(2,1,t.permissionActionLookup(null==e?null:e.Action)))}}function nt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-selector",60),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().item.Action=t})("ngModelChange",function(){o.CHM(e);const t=o.oxw(),n=t.item,i=t.update,s=o.oxw(3);return i.call(null,n),s.onPermissionChanged(n)}),o.qZA()}if(2&e){const e=o.oxw().item,t=o.oxw(3);o.Q6J("ngModel",e.Action)("required",!e.PH)("ngModelOptions",o.DdM(5,Le))("choices",t.permissionActionChoices(e))("disabled",!e.View)}}function it(e,t){if(1&e&&(o.TgZ(0,"t-form-group-cell",56),o.YNc(1,tt,3,3,"div",38),o.YNc(2,nt,1,6,"t-selector",59),o.qZA()),2&e){const e=t.item,n=o.oxw(2).isEdit;o.Q6J("serverErrors",null==e.serverErrors?null:e.serverErrors.Action),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n)}}function st(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.Oqu(o.lcZ(1,1,"Permission_Criteria"))}function ot(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const e=o.oxw().item;o.xp6(1),o.Oqu(e.Criteria)}}function rt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",62),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().item.Criteria=t})("ngModelChange",function(){o.CHM(e);const t=o.oxw();return t.update.call(null,t.item)}),o.qZA()}if(2&e){const e=o.oxw().item,t=o.oxw(3);o.Q6J("ngModel",e.Criteria)("ngModelOptions",o.DdM(3,Le))("disabled",t.disableCriteria(e))}}function lt(e,t){if(1&e&&(o.TgZ(0,"t-form-group-cell",56),o.YNc(1,ot,2,1,"div",38),o.YNc(2,rt,1,4,"t-text-editor",61),o.qZA()),2&e){const e=t.item,n=o.oxw(2).isEdit;o.Q6J("serverErrors",null==e.serverErrors?null:e.serverErrors.Criteria),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n)}}function at(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.Oqu(o.lcZ(1,1,"Memo"))}function ct(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const e=o.oxw().item;o.xp6(1),o.Oqu(e.Memo)}}function ut(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",64),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().item.Memo=t})("ngModelChange",function(){o.CHM(e);const t=o.oxw();return t.update.call(null,t.item)}),o.qZA()}if(2&e){const e=o.oxw().item;o.Q6J("ngModel",e.Memo)("ngModelOptions",o.DdM(2,Le))}}function dt(e,t){if(1&e&&(o.TgZ(0,"t-form-group-cell",56),o.YNc(1,ct,2,1,"div",38),o.YNc(2,ut,1,3,"t-text-editor",63),o.qZA()),2&e){const e=t.item,n=o.oxw(2).isEdit;o.Q6J("serverErrors",null==e.serverErrors?null:e.serverErrors.Memo),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n)}}const mt=function(){return["View","Action","Criteria","Memo"]},pt=function(e,t){return{headerTemplate:e,rowTemplate:t,weight:1}},gt=function(e,t,n,i){return{View:e,Action:t,Criteria:n,Memo:i}};function ht(e,t){if(1&e&&(o.TgZ(0,"t-restricted",8),o._UZ(1,"t-table",47),o.qZA(),o.YNc(2,Ke,2,3,"ng-template",null,48,o.W1O),o.YNc(4,ze,3,3,"ng-template",null,49,o.W1O),o.YNc(6,et,2,3,"ng-template",null,50,o.W1O),o.YNc(8,it,3,3,"ng-template",null,51,o.W1O),o.YNc(10,st,2,3,"ng-template",null,52,o.W1O),o.YNc(12,lt,3,3,"ng-template",null,53,o.W1O),o.YNc(14,at,2,3,"ng-template",null,54,o.W1O),o.YNc(16,dt,3,3,"ng-template",null,55,o.W1O)),2&e){const e=o.MAs(3),t=o.MAs(5),n=o.MAs(7),i=o.MAs(9),s=o.MAs(11),r=o.MAs(13),l=o.MAs(15),a=o.MAs(17),c=o.oxw(),u=c.model,d=c.isEdit;o.ekj("p-4",1===(null==u||null==u.EntityMetadata?null:u.EntityMetadata.Permissions)),o.Q6J("metadata",null==u||null==u.EntityMetadata?null:u.EntityMetadata.Permissions),o.xp6(1),o.Q6J("dataSource",null==u?null:u.Permissions)("isEdit",d)("columnPaths",o.DdM(7,mt))("columnTemplates",o.l5B(20,gt,o.WLB(8,pt,e,t),o.WLB(11,pt,n,i),o.WLB(14,pt,s,r),o.WLB(17,pt,l,a)))}}function ft(e,t){if(1&e&&(o.YNc(0,_e,6,7,"div",12),o.YNc(1,Ee,5,6,"div",12),o.YNc(2,Oe,6,7,"div",12),o.TgZ(3,"t-form-group",13),o.YNc(4,ke,2,1,"h2",14),o.YNc(5,De,2,7,"t-text-editor",15),o.qZA(),o.TgZ(6,"t-form-group",16),o.ALo(7,"translate"),o.YNc(8,Qe,3,4,"t-restricted",17),o.YNc(9,Ye,4,1,"div",18),o.qZA(),o.YNc(10,je,4,6,"t-form-group",19),o.YNc(11,Re,4,6,"t-form-group",19),o.YNc(12,Ve,3,4,"t-form-group",20),o.YNc(13,Be,5,6,"t-form-group",20),o.TgZ(14,"ul",21,22),o.TgZ(16,"li",23),o.TgZ(17,"a",24),o.TgZ(18,"span",25),o._uU(19),o.ALo(20,"translate"),o.ALo(21,"number"),o.qZA(),o.YNc(22,$e,3,0,"span",26),o.qZA(),o.YNc(23,ht,18,25,"ng-template",27),o.qZA(),o.qZA(),o._UZ(24,"div",28)),2&e){const e=t.model,n=t.isEdit,i=o.MAs(15),s=o.oxw();o.Q6J("ngIf",s.showUserNewNotice(e,n)),o.xp6(1),o.Q6J("ngIf",s.showUserFreshInvitedNotice(e)),o.xp6(1),o.Q6J("ngIf",s.showUserExpiredInvitedNotice(e,n)),o.xp6(1),o.Q6J("serverErrors",null==e||null==e.serverErrors?null:e.serverErrors.Name),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n),o.xp6(1),o.Q6J("label",o.lcZ(7,19,"User_IsService"))("serverErrors",null==e||null==e.serverErrors?null:e.serverErrors.IsService),o.xp6(2),o.Q6J("ngIf",!n||!s.isNew),o.xp6(1),o.Q6J("ngIf",n&&s.isNew),o.xp6(1),o.Q6J("ngIf",!(null!=e&&e.IsService)),o.xp6(1),o.Q6J("ngIf",null==e?null:e.IsService),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("destroyOnHide",!0),o.xp6(2),o.Q6J("disabled",!0),o.xp6(3),o.Oqu(o.lcZ(20,21,"User_Permissions")+(e.Id&&2!==(null==e||null==e.EntityMetadata?null:e.EntityMetadata.Permissions)?"":" ("+o.lcZ(21,23,null==e||null==e.Permissions?null:e.Permissions.length)+")")),o.xp6(3),o.Q6J("ngIf",s.showPermissionsError(e)),o.xp6(2),o.Q6J("ngbNavOutlet",i)}}function At(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"Activate")," ")}function wt(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"Deactivate")," ")}function vt(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"SendInvitationEmail")," ")}const Zt=function(e,t,n,i,s){return{template:e,action:t,showAction:n,canAction:i,actionTooltip:s}},xt=function(e,t,n){return[e,t,n]};let bt=(()=>{class e extends Ze.N{constructor(e,t,n,i){super(),this.workspace=e,this.api=t,this.translate=n,this.route=i,this.showRoles=!0,this.expand="Permissions",this.adminUsersApi=this.api.adminUsersApi(this.notifyDestruct$),this._permissionActionChoices={},this._viewsDb=null,this._currentViewsDb=null,this._viewsForSelector=null,this.create=()=>{const e={};return e.Name=this.initialText,e.IsService=!1,e.Permissions=[],e},this.clone=e=>{if(e){const t=JSON.parse(JSON.stringify(e));return t.Id=null,t.Permissions&&t.Permissions.forEach(e=>{e.Id=null}),t}return console.error("Cloning a non existing item"),null},this.onInvite=e=>{e&&e.Id&&this.adminUsersApi.invite([e.Id],{returnEntities:!0}).pipe((0,f.b)(e=>(0,v.DP)(e,this.workspace))).subscribe({error:this.details.handleActionError})},this.showInvite=e=>!!e&&e.State<=1&&this.showInvitedState(e),this.canInvite=e=>this.ws.canDo("admin-users","SendInvitationEmail",e.Id),this.inviteTooltip=e=>this.canInvite(e)?"":this.translate.instant("Error_AccountDoesNotHaveSufficientPermissions"),this.onActivate=e=>{e&&e.Id&&this.adminUsersApi.activate([e.Id],{returnEntities:!0}).pipe((0,f.b)(e=>(0,v.DP)(e,this.workspace))).subscribe({error:this.details.handleActionError})},this.onDeactivate=e=>{e&&e.Id&&this.adminUsersApi.deactivate([e.Id],{returnEntities:!0}).pipe((0,f.b)(e=>(0,v.DP)(e,this.workspace))).subscribe({error:this.details.handleActionError})},this.showActivate=e=>!!e&&!e.IsActive,this.showDeactivate=e=>!!e&&e.IsActive,this.canActivateDeactivateItem=e=>this.ws.canDo("admin-users","IsActive",e.Id),this.activateDeactivateTooltip=e=>this.canActivateDeactivateItem(e)?"":this.translate.instant("Error_AccountDoesNotHaveSufficientPermissions"),this.savePreprocessing=e=>{e.IsService?delete e.Email:delete e.ClientId},this.adminUsersApi=this.api.adminUsersApi(this.notifyDestruct$)}showInvitedState(e){return this.workspace.globalSettings.CanInviteUsers&&!e.IsService}showUserNewNotice(e,t){return!t&&!!e&&!!e.Id&&!e.State&&!e.IsService&&this.workspace.globalSettings.CanInviteUsers}showUserFreshInvitedNotice(e){return!!e&&!!e.Id&&1===e.State&&(0,v.M2)(new Date(e.InvitedAt),new Date)<this.workspace.globalSettings.TokenExpiryInDays}showUserExpiredInvitedNotice(e,t){return!t&&!!e&&!!e.Id&&1===e.State&&(0,v.M2)(new Date(e.InvitedAt),new Date)>=this.workspace.globalSettings.TokenExpiryInDays}get ws(){return this.workspace.admin}showInvitationInfo(e){return!!e&&!!e.Email&&this.isNew}get isNew(){return this.isScreenMode&&"new"===this.route.snapshot.paramMap.get("id")||this.isPopupMode&&"new"===this.idString}showPermissionsError(e){return!!e&&!!e.Permissions&&e.Permissions.some(e=>!!e.serverErrors)}get viewsDb(){if(this._currentLang!==this.translate.currentLang){this._currentLang=this.translate.currentLang,this._viewsDb={};for(const e of Object.keys(xe.XM)){const t=xe.XM[e],n={name:()=>this.translate.instant(t.name),actions:{}};n.actions.All={supportsCriteria:!1},t.read&&(n.actions.Read={supportsCriteria:!0}),t.update&&(n.actions.Update={supportsCriteria:!0}),t.delete&&(n.actions.Delete={supportsCriteria:!0});for(const e of t.actions)n.actions[e.action]={supportsCriteria:e.criteria};this._viewsDb[e]=n}}return this._viewsDb}get permissionViewChoices(){if(this._currentViewsDb!==this.viewsDb){const e=this.viewsDb;this._currentViewsDb=e,this._viewsForSelector=Object.keys(e).map(t=>({value:t,name:e[t].name})),this._viewsForSelector.sort((e,t)=>e.name()<t.name()?-1:e.name()>t.name()?1:0)}return this._viewsForSelector}permissionViewLookup(e){return e?this.viewsDb[e]?this.viewsDb[e].name():(console.error(`missing view ${e}`),""):""}onPermissionChanged(e){const t=this.permissionActionChoices(e);1===t.length?e.Action=t[0].value:!!e.Action&&t.every(t=>t.value!==e.Action)&&(e.Action=null),this.disableCriteria(e)&&(e.Criteria=null)}disableCriteria(e){if(!e||!e.View||!e.Action)return!0;const t=this.viewsDb[e.View];if(t&&t.actions){const n=t.actions[e.Action];return!(n&&n.supportsCriteria)}return!0}permissionActionChoices(e){if(!e.View)return[];if(!this._permissionActionChoices[e.View]){const t=this.viewsDb[e.View];this._permissionActionChoices[e.View]=t&&t.actions?Object.keys(t.actions).map(e=>({name:()=>this.translate.instant(xe.aO[e]),value:e})):[]}return this._permissionActionChoices[e.View]}permissionActionLookup(e){return e?"All"===e?"View_All":xe.aO[e]:""}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW),o.Y36(q.s),o.Y36(l.sK),o.Y36(i.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-admin-users-details"]],inputs:{showRoles:"showRoles"},features:[o.qOj],decls:14,vars:36,consts:[["collection","AdminUser",3,"expand","idString","createFunc","cloneFunc","mode","additionalSelect","masterCrumb","detailsCrumb","documentTemplate","documentHeaderTemplate","savePreprocessing","actions"],["detailsCrumb",""],["documentHeader",""],["document",""],["activate",""],["deactivate",""],["invite",""],[1,"w-100","t-document-header","d-flex","justify-content-end"],[3,"metadata"],[1,"t-flow-chart","small"],[3,"active",4,"ngIf"],[1,"small","t-lone-state","active","d-none"],["class","col-12 alert-primary p-2 px-3 mb-3 mb-sm-4",4,"ngIf"],[1,"col-12","mb-2","mb-sm-4","t-h2",3,"serverErrors"],["class","font-weight-normal",4,"ngIf"],["required","",3,"focusIf","ngModel","ngModelOptions","placeholder","ngModelChange",4,"ngIf"],[1,"t-form-group",3,"label","serverErrors"],[3,"metadata",4,"ngIf"],["class","custom-control custom-checkbox t-labelless-checkbox",4,"ngIf"],["class","t-form-group",3,"label","serverErrors",4,"ngIf"],["class","t-form-group",3,"label",4,"ngIf"],["ngbNav","",1,"pt-3","pt-sm-4","w-100","nav-tabs",3,"destroyOnHide"],["tabs","ngbNav"],["ngbNavItem","permissions",3,"disabled"],["ngbNavLink",""],[1,"small","t-slightly-bold"],["class","text-danger",4,"ngIf"],["ngbNavContent",""],[1,"w-100",3,"ngbNavOutlet"],[1,"col-12","alert-primary","p-2","px-3","mb-3","mb-sm-4"],["icon","info-circle"],["class","btn btn-primary btn-sm py-0 align-baseline",3,"click",4,"ngIf"],[1,"btn","btn-primary","btn-sm","py-0","align-baseline",3,"click"],[1,"font-weight-normal"],["required","",3,"focusIf","ngModel","ngModelOptions","placeholder","ngModelChange"],[1,"custom-control","custom-checkbox","t-labelless-checkbox"],["type","checkbox","id","isService",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","isService",1,"custom-control-label","t-pointer"],[4,"ngIf"],["required","","email","",3,"ngModel","ngModelOptions","disabled","ngModelChange",4,"ngIf"],["required","","email","",3,"ngModel","ngModelOptions","disabled","ngModelChange"],["required","",3,"ngModel","ngModelOptions","disabled","ngModelChange",4,"ngIf"],["required","",3,"ngModel","ngModelOptions","disabled","ngModelChange"],[1,"t-form-group",3,"label"],["collection","AdminUser","path","LastAccess",3,"entity"],[1,"text-danger"],["icon","exclamation"],[3,"dataSource","isEdit","columnPaths","columnTemplates"],["header_View",""],["row_View",""],["header_Action",""],["row_Action",""],["header_Criteria",""],["row_Criteria",""],["header_Memo",""],["row_Memo",""],[1,"t-form-group",3,"serverErrors"],[3,"choices","ngModel","required","ngModelChange",4,"ngIf"],[3,"choices","ngModel","required","ngModelChange"],[3,"ngModel","required","ngModelOptions","choices","disabled","ngModelChange",4,"ngIf"],[3,"ngModel","required","ngModelOptions","choices","disabled","ngModelChange"],[3,"ngModel","ngModelOptions","disabled","ngModelChange",4,"ngIf"],[3,"ngModel","ngModelOptions","disabled","ngModelChange"],[3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange"]],template:function(e,t){if(1&e&&(o._UZ(0,"t-details",0),o.ALo(1,"translate"),o.YNc(2,qe,2,1,"ng-template",null,1,o.W1O),o.YNc(4,Ie,16,15,"ng-template",null,2,o.W1O),o.YNc(6,ft,25,25,"ng-template",null,3,o.W1O),o.YNc(8,At,2,3,"ng-template",null,4,o.W1O),o.YNc(10,wt,2,3,"ng-template",null,5,o.W1O),o.YNc(12,vt,2,3,"ng-template",null,6,o.W1O)),2&e){const e=o.MAs(3),n=o.MAs(5),i=o.MAs(7),s=o.MAs(9),r=o.MAs(11),l=o.MAs(13);o.Q6J("expand",t.expand)("idString",t.idString)("createFunc",t.create)("cloneFunc",t.clone)("mode",t.mode)("additionalSelect",t.additionalSelect)("masterCrumb",o.lcZ(1,12,"AdminUsers"))("detailsCrumb",e)("documentTemplate",i)("documentHeaderTemplate",n)("savePreprocessing",t.savePreprocessing)("actions",o.kEZ(32,xt,o.qbA(14,Zt,l,t.onInvite,t.showInvite,t.canInvite,t.inviteTooltip),o.qbA(20,Zt,s,t.onActivate,t.showActivate,t.canActivateDeactivateItem,t.activateDeactivateTooltip),o.qbA(26,Zt,r,t.onDeactivate,t.showDeactivate,t.canActivateDeactivateItem,t.activateDeactivateTooltip)))}},directives:[Z.MC,be.s,a.O5,S.H,U.Pz,U.nv,U.Vx,U.uN,U.tO,c.BN,T.d,_.Q7,_.JJ,_.On,_.Wl,_.on,z.q_,Me.a,ye.s,Ce.i],pipes:[l.X$,a.JJ],encapsulation:2}),e})();var Mt=n(9976);function yt(e,t){if(1&e&&(o.TgZ(0,"div",8),o._UZ(1,"t-auto-cell",9),o.qZA(),o.TgZ(2,"div",10),o.TgZ(3,"span",11),o._uU(4,"\xa0"),o.qZA(),o.qZA()),2&e){const e=t.id,n=o.oxw();o.xp6(1),o.Q6J("entity",n.c[e])}}function Ct(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"IdentityServerUser"),"\n")}function qt(e,t){if(1&e&&o._UZ(0,"t-auto-cell",12),2&e){const e=t.id,n=o.oxw();o.Q6J("entity",n.c[e])}}function Ut(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"EmailConfirmed")," ")}function It(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"EmailNotConfirmed")," ")}function St(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"PasswordIsSet")," ")}function Tt(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"PasswordIsNotSet")," ")}const _t=function(){return[]},Nt=function(e){return{template:e,expression:"EmailConfirmed eq true"}},Et=function(e){return{template:e,expression:"EmailConfirmed eq false"}},Jt=function(e,t){return[e,t]},Ot=function(e){return{template:e,expression:"PasswordSet eq true"}},kt=function(e){return{template:e,expression:"PasswordSet eq false"}},Lt=function(e,t){return{EmailConfirmed:e,PasswordSet:t}};let Dt=(()=>{class e extends X.W{constructor(e){super(),this.workspace=e}get c(){return this.ws.IdentityServerUser}get ws(){return this.workspace.admin}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-identity-server-users-master"]],features:[o.qOj],decls:16,vars:32,consts:[["collection","IdentityServerUser","selectDefault","EmailConfirmed,PasswordSet,TwoFactorEnabled","selectForTiles","Email",3,"mode","showCreateButton","filterDefault","additionalSelect","masterCrumb","tileTemplate","tableSummaryColumnTemplate","tableSummaryHeaderTemplate","showImportButton","showDeleteButton","multiselectActions","filterDefinition"],["tile",""],["summaryHeader",""],["summaryColumn",""],["emailConfirmed",""],["emailNotConfirmed",""],["passwordSet",""],["passwordNotSet",""],[1,"d-flex","justify-content-between"],["collection","IdentityServerUser","path","Email",3,"entity"],[1,"d-flex","justify-content-between","mt-1","small"],[1,"d-block","text-truncate"],["collection","IdentityServerUser",3,"entity"]],template:function(e,t){if(1&e&&(o._UZ(0,"t-master",0),o.ALo(1,"translate"),o.YNc(2,yt,5,1,"ng-template",null,1,o.W1O),o.YNc(4,Ct,2,3,"ng-template",null,2,o.W1O),o.YNc(6,qt,1,1,"ng-template",null,3,o.W1O),o.YNc(8,Ut,2,3,"ng-template",null,4,o.W1O),o.YNc(10,It,2,3,"ng-template",null,5,o.W1O),o.YNc(12,St,2,3,"ng-template",null,6,o.W1O),o.YNc(14,Tt,2,3,"ng-template",null,7,o.W1O)),2&e){const e=o.MAs(3),n=o.MAs(5),i=o.MAs(7),s=o.MAs(9),r=o.MAs(11),l=o.MAs(13),a=o.MAs(15);o.Q6J("mode",t.mode)("showCreateButton",!1)("filterDefault",t.filter)("additionalSelect",t.additionalSelect)("masterCrumb",o.lcZ(1,12,"IdentityServerUsers"))("tileTemplate",e)("tableSummaryColumnTemplate",i)("tableSummaryHeaderTemplate",n)("showImportButton",!1)("showDeleteButton",!1)("multiselectActions",o.DdM(14,_t))("filterDefinition",o.WLB(29,Lt,o.WLB(19,Jt,o.VKq(15,Nt,s),o.VKq(17,Et,r)),o.WLB(26,Jt,o.VKq(22,Ot,l),o.VKq(24,kt,a))))}},directives:[G.c,z.q_],pipes:[l.X$],encapsulation:2}),e})();const Qt=["resetPasswordModal"];function Yt(e,t){if(1&e&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&e){const e=t.model;o.xp6(1),o.Oqu(null==e?null:e.Email)}}function Pt(e,t){if(1&e&&(o.TgZ(0,"t-form-group",5),o.TgZ(1,"h2",6),o._uU(2),o.qZA(),o.qZA(),o.TgZ(3,"t-form-group",7),o.ALo(4,"translate"),o.TgZ(5,"div"),o._uU(6),o.ALo(7,"translate"),o.qZA(),o.qZA(),o.TgZ(8,"t-form-group",7),o.ALo(9,"translate"),o.TgZ(10,"div"),o._uU(11),o.ALo(12,"translate"),o.qZA(),o.qZA(),o.TgZ(13,"t-form-group",7),o.ALo(14,"translate"),o.TgZ(15,"div"),o._uU(16),o.ALo(17,"translate"),o.qZA(),o.qZA(),o.TgZ(18,"t-form-group",7),o.ALo(19,"translate"),o._UZ(20,"t-auto-cell",8),o.qZA()),2&e){const e=t.model;o.xp6(2),o.Oqu(null==e?null:e.Email),o.xp6(1),o.Q6J("label",o.lcZ(4,9,"IdentityServerUser_EmailConfirmed")),o.xp6(3),o.hij("",o.lcZ(7,11,!0===e.EmailConfirmed?"Yes":!1===e.EmailConfirmed?"No":"")," "),o.xp6(2),o.Q6J("label",o.lcZ(9,13,"IdentityServerUser_PasswordSet")),o.xp6(3),o.hij("",o.lcZ(12,15,!0===e.PasswordSet?"Yes":!1===e.PasswordSet?"No":"")," "),o.xp6(2),o.Q6J("label",o.lcZ(14,17,"IdentityServerUser_TwoFactorEnabled")),o.xp6(3),o.hij("",o.lcZ(17,19,!0===e.TwoFactorEnabled?"Yes":!1===e.TwoFactorEnabled?"No":"")," "),o.xp6(2),o.Q6J("label",o.lcZ(19,21,"IdentityServerUser_LockoutEnd")),o.xp6(2),o.Q6J("entity",e)}}function Ft(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"ResetPassword")," ")}function jt(e,t){if(1&e&&(o.TgZ(0,"t-error-message"),o._uU(1),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.hij(" ",e.resetPasswordError," ")}}function Ht(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",9),o.TgZ(1,"h5",10),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"button",11),o.NdJ("click",function(){return o.CHM(e).$implicit.dismiss()}),o.TgZ(5,"span",12),o._uU(6,"\xd7"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(7,"div",13),o.TgZ(8,"t-form-group",14),o.ALo(9,"translate"),o.TgZ(10,"div"),o._uU(11),o.qZA(),o.qZA(),o.TgZ(12,"t-form-group",14),o.ALo(13,"translate"),o.TgZ(14,"t-text-editor",15),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().newPassword=t}),o.qZA(),o.TgZ(15,"label",16),o.NdJ("click",function(){return o.CHM(e),o.oxw().togglePasswordVisibility()}),o.ALo(16,"translate"),o._UZ(17,"fa-icon",17),o.qZA(),o.qZA(),o.YNc(18,jt,2,1,"t-error-message",18),o.qZA(),o.TgZ(19,"div",19),o.TgZ(20,"button",20),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw().resetPasswordClick(t)}),o._UZ(21,"fa-icon",21),o._uU(22),o.ALo(23,"translate"),o.qZA(),o.TgZ(24,"button",22),o.NdJ("click",function(){return o.CHM(e).$implicit.dismiss()}),o._UZ(25,"fa-icon",23),o._uU(26),o.ALo(27,"translate"),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(2),o.hij(" ",o.lcZ(3,15,"ResetPassword")," "),o.xp6(6),o.Q6J("label",o.lcZ(9,17,"User_Email"))("serverErrors",null),o.xp6(3),o.Oqu(null==e.modelRef?null:e.modelRef.Email),o.xp6(1),o.Q6J("label",o.lcZ(13,19,"NewPassword"))("serverErrors",null),o.xp6(2),o.Q6J("ngModel",e.newPassword)("type",e.passwordFieldType)("focusIf",!0),o.xp6(1),o.s9C("title",o.lcZ(16,21,"ShowHidePassword")),o.xp6(2),o.Q6J("icon",e.isPasswordShown?"eye-slash":"eye"),o.xp6(1),o.Q6J("ngIf",!!e.resetPasswordError),o.xp6(2),o.Q6J("disabled",!e.newPassword),o.xp6(2),o.hij(" \xa0",o.lcZ(23,23,"ResetPassword")," "),o.xp6(4),o.hij(" \xa0",o.lcZ(27,25,"Cancel")," ")}}const Wt=function(e,t,n,i,s){return{template:e,action:t,showAction:n,canAction:i,actionTooltip:s}},Rt=function(e){return[e]};let Vt=(()=>{class e extends Ze.N{constructor(e,t,n,i){super(),this.workspace=e,this.api=t,this.translate=n,this.modalService=i,this.expand="",this._showPassword=!1,this.identityServerUsersApi=this.api.identityServerUsersApi(this.notifyDestruct$),this.onResetPassword=e=>{e&&e.Id&&(this.modelRef=e,this.modalService.open(this.resetPasswordModal).result.then(()=>{this.resetPasswordError=null,this.newPassword=null,this._showPassword=!1},e=>{this.resetPasswordError=null,this.newPassword=null,this._showPassword=!1}))},this.showResetPassword=e=>!!e,this.canResetPassword=e=>this.ws.canDo("identity-server-users","ResetPassword",e.Id),this.resetPasswordTooltip=e=>this.canResetPassword(e)?"":this.translate.instant("Error_AccountDoesNotHaveSufficientPermissions"),this.identityServerUsersApi=this.api.identityServerUsersApi(this.notifyDestruct$)}get ws(){return this.workspace.admin}resetPasswordClick(e){this.resetPasswordError=null,this.identityServerUsersApi.resetPassword({userId:this.modelRef.Id,password:this.newPassword}).pipe((0,f.b)(t=>{(0,v.DP)(t,this.workspace),e.close(),this.details.displayModalMessage(this.translate.instant("PasswordWasSuccessfullyReset"))}),(0,A.K)(e=>this.resetPasswordError=e.error)).subscribe()}togglePasswordVisibility(){this._showPassword=!this._showPassword}get isPasswordShown(){return this._showPassword}get passwordFieldType(){return this.isPasswordShown?"text":"password"}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW),o.Y36(q.s),o.Y36(l.sK),o.Y36(U.FF))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-identity-server-users-details"]],viewQuery:function(e,t){if(1&e&&o.Gf(Qt,7),2&e){let e;o.iGM(e=o.CRH())&&(t.resetPasswordModal=e.first)}},features:[o.qOj],decls:10,vars:21,consts:[["collection","IdentityServerUser",3,"expand","idString","mode","additionalSelect","showCreateButton","showDeleteButton","showEditButton","masterCrumb","detailsCrumb","documentTemplate","actions"],["detailsCrumb",""],["document",""],["resetPassword",""],["resetPasswordModal",""],[1,"col-12","mb-2","mb-sm-4","t-h2"],[1,"font-weight-normal"],[1,"t-form-group",3,"label"],["collection","IdentityServerUser","path","LockoutEnd",3,"entity"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"t-form-group",3,"label","serverErrors"],["required","",3,"ngModel","type","focusIf","ngModelChange"],[1,"btn","btn-sm","text-primary","t-pointer","mx-1",3,"title","click"],[3,"icon"],[4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-primary",3,"disabled","click"],["icon","check"],[1,"btn","btn-light","text-primary","t-white-button",3,"click"],["icon","times"]],template:function(e,t){if(1&e&&(o._UZ(0,"t-details",0),o.ALo(1,"translate"),o.YNc(2,Yt,2,1,"ng-template",null,1,o.W1O),o.YNc(4,Pt,21,23,"ng-template",null,2,o.W1O),o.YNc(6,Ft,2,3,"ng-template",null,3,o.W1O),o.YNc(8,Ht,28,27,"ng-template",null,4,o.W1O)),2&e){const e=o.MAs(3),n=o.MAs(5),i=o.MAs(7);o.Q6J("expand",t.expand)("idString",t.idString)("mode",t.mode)("additionalSelect",t.additionalSelect)("showCreateButton",!1)("showDeleteButton",!1)("showEditButton",!1)("masterCrumb",o.lcZ(1,11,"IdentityServerUsers"))("detailsCrumb",e)("documentTemplate",n)("actions",o.VKq(19,Rt,o.qbA(13,Wt,i,t.onResetPassword,t.showResetPassword,t.canResetPassword,t.resetPasswordTooltip)))}},directives:[Z.MC,S.H,z.q_,T.d,_.Q7,_.JJ,_.On,c.BN,a.O5,N.H],pipes:[l.X$],encapsulation:2}),e})();const Bt=["resetSecretConfirmModal"];function $t(e,t){if(1&e&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&e){const e=t.model;o.xp6(1),o.Oqu(null==e?null:e.Name)}}function Kt(e,t){if(1&e&&(o.TgZ(0,"h2",11),o._uU(1),o.qZA()),2&e){const e=o.oxw().model;o.xp6(1),o.Oqu(null==e?null:e.Name)}}const Xt=function(){return{updateOn:"blur"}};function Gt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",12),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().model.Name=t}),o.ALo(1,"translate"),o.qZA()}if(2&e){const e=o.oxw().model;o.Q6J("focusIf",!e.Id)("ngModel",e.Name)("ngModelOptions",o.DdM(6,Xt))("placeholder",o.lcZ(1,4,"Name"))}}function zt(e,t){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const e=o.oxw().model;o.xp6(1),o.Oqu(null==e?null:e.Memo)}}function en(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"t-text-editor",13),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().model.Memo=t}),o.qZA()}if(2&e){const e=o.oxw().model;o.Q6J("ngModel",e.Memo)("ngModelOptions",o.DdM(2,Xt))}}function tn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div"),o._uU(1),o.TgZ(2,"button",17),o.NdJ("click",function(){return o.CHM(e),o.oxw(3).onHideSecret()}),o._uU(3,"Hide"),o.qZA(),o.qZA()}if(2&e){const e=o.oxw(2).model;o.xp6(1),o.Oqu(null==e?null:e.ClientSecret)}}function nn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"span"),o._uU(2,"**********"),o.qZA(),o.TgZ(3,"button",17),o.NdJ("click",function(){o.CHM(e);const t=o.oxw(2).model;return o.oxw().onShowSecret(t)}),o._uU(4,"Show"),o.qZA(),o.qZA()}}function sn(e,t){if(1&e&&(o.ynx(0),o._UZ(1,"div",14),o.TgZ(2,"t-form-group",8),o.ALo(3,"translate"),o.TgZ(4,"div"),o._uU(5),o.qZA(),o.qZA(),o.TgZ(6,"t-form-group",8),o.ALo(7,"translate"),o.YNc(8,tn,4,1,"div",15),o.YNc(9,nn,5,0,"ng-template",null,16,o.W1O),o.qZA(),o.BQk()),2&e){const e=o.MAs(10),t=o.oxw().model,n=o.oxw();o.xp6(2),o.Q6J("label",o.lcZ(3,7,"IdentityServerClient_ClientId"))("serverErrors",null==t||null==t.serverErrors?null:t.serverErrors.ClientId),o.xp6(3),o.Oqu(null==t?null:t.ClientId),o.xp6(1),o.Q6J("label",o.lcZ(7,9,"IdentityServerClient_ClientSecret"))("serverErrors",null==t||null==t.serverErrors?null:t.serverErrors.ClientSecret),o.xp6(2),o.Q6J("ngIf",n.showSecret(t))("ngIfElse",e)}}function on(e,t){if(1&e&&(o.TgZ(0,"t-form-group",5),o.YNc(1,Kt,2,1,"h2",6),o.YNc(2,Gt,2,7,"t-text-editor",7),o.qZA(),o.TgZ(3,"t-form-group",8),o.ALo(4,"translate"),o.YNc(5,zt,2,1,"div",9),o.YNc(6,en,1,3,"t-text-editor",10),o.qZA(),o.YNc(7,sn,11,11,"ng-container",9)),2&e){const e=t.model,n=t.isEdit,i=o.oxw();o.Q6J("serverErrors",null==e||null==e.serverErrors?null:e.serverErrors.Name),o.xp6(1),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n),o.xp6(1),o.Q6J("label",o.lcZ(4,8,"Memo"))("serverErrors",null==e||null==e.serverErrors?null:e.serverErrors.Memo),o.xp6(2),o.Q6J("ngIf",!n),o.xp6(1),o.Q6J("ngIf",n),o.xp6(1),o.Q6J("ngIf",!i.isNew)}}function rn(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"ResetSecret")," ")}function ln(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",18),o.TgZ(1,"h5",19),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"button",20),o.NdJ("click",function(){return o.CHM(e).$implicit.dismiss()}),o.TgZ(5,"span",21),o._uU(6,"\xd7"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(7,"div",22),o._uU(8),o.ALo(9,"translate"),o.qZA(),o.TgZ(10,"div",23),o.TgZ(11,"button",24),o.NdJ("click",function(){const t=o.CHM(e).$implicit,n=o.oxw();return t.dismiss(),n.doResetSecret()}),o._UZ(12,"fa-icon",25),o._uU(13),o.ALo(14,"translate"),o.qZA(),o.TgZ(15,"button",26),o.NdJ("click",function(){return o.CHM(e).$implicit.dismiss()}),o._UZ(16,"fa-icon",27),o._uU(17),o.ALo(18,"translate"),o.qZA(),o.qZA()}2&e&&(o.xp6(2),o.hij(" ",o.lcZ(3,4,"Confirmation")," "),o.xp6(6),o.hij(" ",o.lcZ(9,6,"ResetSecretConfirmationMessage")," "),o.xp6(5),o.hij(" \xa0",o.lcZ(14,8,"Proceed")," "),o.xp6(4),o.hij(" \xa0",o.lcZ(18,10,"Cancel")," "))}const an=function(e,t,n,i,s){return{template:e,action:t,showAction:n,canAction:i,actionTooltip:s}},cn=function(e){return[e]};let un=(()=>{class e extends Ze.N{constructor(e,t,n,i,s){super(),this.workspace=e,this.route=t,this.api=n,this.translate=i,this.modalService=s,this.clientsApi=this.api.identityServerClientsApi(this.notifyDestruct$),this.expand="",this.create=()=>{const e={};return e.Name=this.initialText,e},this.clone=e=>{if(e){const t=JSON.parse(JSON.stringify(e));return t.Id=null,delete t.ClientId,delete t.ClientSecret,t}return console.error("Cloning a non existing item"),null},this.onResetSecret=e=>{this.modelRef=e,this.modalService.open(this.unsavedChangesModal)},this.doResetSecret=()=>{const e=this.modelRef;this.showResetSecret(e)&&this.clientsApi.resetSecret({id:e.Id,returnEntities:!0}).pipe((0,f.b)(e=>{(0,v.DP)(e,this.workspace),this.details.displayModalMessage(this.translate.instant("ResetSecretSuccessMessage"))})).subscribe({error:this.details.handleActionError})},this.showResetSecret=e=>!!e&&!!e.Id,this.canResetSecret=e=>this.ws.canDo("identity-server-clients","Update",e.Id),this.resetSecretTooltip=e=>this.canResetSecret(e)?"":this.translate.instant("Error_AccountDoesNotHaveSufficientPermissions"),this.clientsApi=this.api.identityServerClientsApi(this.notifyDestruct$)}get ws(){return this.workspace.admin}get isNew(){return this.isScreenMode&&"new"===this.route.snapshot.paramMap.get("id")||this.isPopupMode&&"new"===this.idString}isInactive(){return!1}showSecret(e){return this.modelForShowClientSecret===e||(delete this.modelForShowClientSecret,!1)}onShowSecret(e){this.modelForShowClientSecret=e}onHideSecret(){delete this.modelForShowClientSecret}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW),o.Y36(i.gz),o.Y36(q.s),o.Y36(l.sK),o.Y36(U.FF))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-identity-server-clients-details"]],viewQuery:function(e,t){if(1&e&&o.Gf(Bt,7),2&e){let e;o.iGM(e=o.CRH())&&(t.unsavedChangesModal=e.first)}},features:[o.qOj],decls:10,vars:21,consts:[["collection","IdentityServerClient",3,"expand","idString","createFunc","cloneFunc","mode","additionalSelect","masterCrumb","detailsCrumb","documentTemplate","actions","isInactive"],["detailsCrumb",""],["document",""],["resetSecret",""],["resetSecretConfirmModal",""],[1,"col-12","mb-2","mb-sm-4","t-h2",3,"serverErrors"],["class","font-weight-normal",4,"ngIf"],["required","",3,"focusIf","ngModel","ngModelOptions","placeholder","ngModelChange",4,"ngIf"],[1,"t-form-group",3,"label","serverErrors"],[4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"font-weight-normal"],["required","",3,"focusIf","ngModel","ngModelOptions","placeholder","ngModelChange"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-12"],[4,"ngIf","ngIfElse"],["stars",""],[1,"btn","btn-sm","btn-light","text-primary","t-white-button","py-0","align-baseline","mx-2",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],[1,"btn","btn-danger",3,"click"],["icon","check"],["ngbAutofocus","",1,"btn","btn-light","text-primary","t-white-button",3,"click"],["icon","times"]],template:function(e,t){if(1&e&&(o._UZ(0,"t-details",0),o.ALo(1,"translate"),o.YNc(2,$t,2,1,"ng-template",null,1,o.W1O),o.YNc(4,on,8,10,"ng-template",null,2,o.W1O),o.YNc(6,rn,2,3,"ng-template",null,3,o.W1O),o.YNc(8,ln,19,12,"ng-template",null,4,o.W1O)),2&e){const e=o.MAs(3),n=o.MAs(5),i=o.MAs(7);o.Q6J("expand",t.expand)("idString",t.idString)("createFunc",t.create)("cloneFunc",t.clone)("mode",t.mode)("additionalSelect",t.additionalSelect)("masterCrumb",o.lcZ(1,11,"IdentityServerClients"))("detailsCrumb",e)("documentTemplate",n)("actions",o.VKq(19,cn,o.qbA(13,an,i,t.onResetSecret,t.showResetSecret,t.canResetSecret,t.resetSecretTooltip)))("isInactive",t.isInactive)}},directives:[Z.MC,S.H,a.O5,T.d,_.Q7,_.JJ,_.On,c.BN],pipes:[l.X$],encapsulation:2}),e})();function dn(e,t){if(1&e&&(o.TgZ(0,"div",5),o._UZ(1,"t-auto-cell",6),o.qZA(),o.TgZ(2,"div",7),o._UZ(3,"t-auto-cell",8),o.qZA()),2&e){const e=t.id,n=o.oxw();o.xp6(1),o.Q6J("entity",n.c[e]),o.xp6(2),o.Q6J("entity",n.c[e])}}function mn(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"IdentityServerClient"),"\n")}function pn(e,t){if(1&e&&o._UZ(0,"t-auto-cell",9),2&e){const e=t.id,n=o.oxw();o.Q6J("entity",n.c[e])}}function gn(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"CreatedByMe")," ")}const hn=function(){return[]},fn=function(e){return{template:e,expression:"CreatedById eq me"}},An=function(e){return[e]},wn=function(e){return{CreatedBy:e}},vn=[{path:"console",component:R,canActivate:[B.xw],canActivateChild:[$.a],children:[{path:"identity-server-users",component:Dt,canDeactivate:[K.N]},{path:"identity-server-users/:id",component:Vt,canDeactivate:[V.O]},{path:"identity-server-clients",component:(()=>{class e extends X.W{constructor(e){super(),this.workspace=e}get c(){return this.ws.IdentityServerClient}get ws(){return this.workspace.admin}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.AW))},e.\u0275cmp=o.Xpm({type:e,selectors:[["t-identity-server-clients-master"]],features:[o.qOj],decls:10,vars:19,consts:[["collection","IdentityServerClient","selectDefault","Memo,ClientId","selectForTiles","ClientId",3,"mode","showCreateButton","filterDefault","additionalSelect","masterCrumb","tileTemplate","tableSummaryColumnTemplate","tableSummaryHeaderTemplate","multiselectActions","filterDefinition"],["tile",""],["summaryHeader",""],["summaryColumn",""],["createdByMe",""],[1,"d-flex","justify-content-between"],["collection","IdentityServerClient","path","",3,"entity"],[1,"d-flex","justify-content-between","mt-1","small"],["collection","IdentityServerClient","path","ClientId",3,"entity"],["collection","IdentityServerClient",3,"entity"]],template:function(e,t){if(1&e&&(o._UZ(0,"t-master",0),o.ALo(1,"translate"),o.YNc(2,dn,4,2,"ng-template",null,1,o.W1O),o.YNc(4,mn,2,3,"ng-template",null,2,o.W1O),o.YNc(6,pn,1,1,"ng-template",null,3,o.W1O),o.YNc(8,gn,2,3,"ng-template",null,4,o.W1O)),2&e){const e=o.MAs(3),n=o.MAs(5),i=o.MAs(7),s=o.MAs(9);o.Q6J("mode",t.mode)("showCreateButton",t.showCreate)("filterDefault",t.filter)("additionalSelect",t.additionalSelect)("masterCrumb",o.lcZ(1,10,"IdentityServerClients"))("tileTemplate",e)("tableSummaryColumnTemplate",i)("tableSummaryHeaderTemplate",n)("multiselectActions",o.DdM(12,hn))("filterDefinition",o.VKq(17,wn,o.VKq(15,An,o.VKq(13,fn,s))))}},directives:[G.c,z.q_],pipes:[l.X$],encapsulation:2}),e})(),canDeactivate:[K.N]},{path:"identity-server-clients/:id",component:un,canDeactivate:[V.O]},{path:"admin-users",component:ve,canDeactivate:[K.N]},{path:"admin-users/:id",component:bt,canDeactivate:[V.O]},{path:"main-menu",component:d,canDeactivate:[K.N]},{path:"",redirectTo:"main-menu",pathMatch:"full"},{path:"**",component:m}]},{path:"",redirectTo:"/root/welcome",pathMatch:"full"}];let Zn=(()=>{class e{constructor(e){e.addIcons(Mt.U7t,Mt.Mdf,Mt.Aq)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(c.by))},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[s.m,i.Bz.forChild(vn)]]}),e})()}}]);