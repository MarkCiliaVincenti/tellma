CREATE FUNCTION [dbo].[fn_UmAlQura_DateFromParts]
(
	@UqYear INT,
	@UqMonth INT,
	@UqDay INT
)
RETURNS DATE
AS
BEGIN
	DECLARE @MuharramFirst DATE = CASE @UqYear
        WHEN 1318 THEN N'1900-04-30' WHEN 1319 THEN N'1901-04-19' WHEN 1320 THEN N'1902-04-09' WHEN 1321 THEN N'1903-03-30'
        WHEN 1322 THEN N'1904-03-18' WHEN 1323 THEN N'1905-03-07' WHEN 1324 THEN N'1906-02-24' WHEN 1325 THEN N'1907-02-13'
        WHEN 1326 THEN N'1908-02-03' WHEN 1327 THEN N'1909-01-23' WHEN 1328 THEN N'1910-01-12' WHEN 1329 THEN N'1911-01-01'
        WHEN 1330 THEN N'1911-12-21' WHEN 1331 THEN N'1912-12-09' WHEN 1332 THEN N'1913-11-29' WHEN 1333 THEN N'1914-11-18'
        WHEN 1334 THEN N'1915-11-08' WHEN 1335 THEN N'1916-10-27' WHEN 1336 THEN N'1917-10-17' WHEN 1337 THEN N'1918-10-06'
        WHEN 1338 THEN N'1919-09-25' WHEN 1339 THEN N'1920-09-13' WHEN 1340 THEN N'1921-09-03' WHEN 1341 THEN N'1922-08-23'
        WHEN 1342 THEN N'1923-08-13' WHEN 1343 THEN N'1924-08-01' WHEN 1344 THEN N'1925-07-21' WHEN 1345 THEN N'1926-07-10'
        WHEN 1346 THEN N'1927-06-30' WHEN 1347 THEN N'1928-06-18' WHEN 1348 THEN N'1929-06-08' WHEN 1349 THEN N'1930-05-29'
        WHEN 1350 THEN N'1931-05-18' WHEN 1351 THEN N'1932-05-06' WHEN 1352 THEN N'1933-04-25' WHEN 1353 THEN N'1934-04-14'
        WHEN 1354 THEN N'1935-04-04' WHEN 1355 THEN N'1936-03-24' WHEN 1356 THEN N'1937-03-13' WHEN 1357 THEN N'1938-03-03'
        WHEN 1358 THEN N'1939-02-20' WHEN 1359 THEN N'1940-02-09' WHEN 1360 THEN N'1941-01-28' WHEN 1361 THEN N'1942-01-17'
        WHEN 1362 THEN N'1943-01-07' WHEN 1363 THEN N'1943-12-28' WHEN 1364 THEN N'1944-12-16' WHEN 1365 THEN N'1945-12-05'
        WHEN 1366 THEN N'1946-11-24' WHEN 1367 THEN N'1947-11-13' WHEN 1368 THEN N'1948-11-02' WHEN 1369 THEN N'1949-10-22'
        WHEN 1370 THEN N'1950-10-12' WHEN 1371 THEN N'1951-10-02' WHEN 1372 THEN N'1952-09-20' WHEN 1373 THEN N'1953-09-09'
        WHEN 1374 THEN N'1954-08-29' WHEN 1375 THEN N'1955-08-18' WHEN 1376 THEN N'1956-08-07' WHEN 1377 THEN N'1957-07-28'
        WHEN 1378 THEN N'1958-07-17' WHEN 1379 THEN N'1959-07-07' WHEN 1380 THEN N'1960-06-25' WHEN 1381 THEN N'1961-06-14'
        WHEN 1382 THEN N'1962-06-03' WHEN 1383 THEN N'1963-05-24' WHEN 1384 THEN N'1964-05-12' WHEN 1385 THEN N'1965-05-02'
        WHEN 1386 THEN N'1966-04-21' WHEN 1387 THEN N'1967-04-10' WHEN 1388 THEN N'1968-03-29' WHEN 1389 THEN N'1969-03-19'
        WHEN 1390 THEN N'1970-03-08' WHEN 1391 THEN N'1971-02-26' WHEN 1392 THEN N'1972-02-16' WHEN 1393 THEN N'1973-02-04'
        WHEN 1394 THEN N'1974-01-24' WHEN 1395 THEN N'1975-01-13' WHEN 1396 THEN N'1976-01-02' WHEN 1397 THEN N'1976-12-22'
        WHEN 1398 THEN N'1977-12-11' WHEN 1399 THEN N'1978-12-01' WHEN 1400 THEN N'1979-11-20' WHEN 1401 THEN N'1980-11-08'
        WHEN 1402 THEN N'1981-10-28' WHEN 1403 THEN N'1982-10-18' WHEN 1404 THEN N'1983-10-07' WHEN 1405 THEN N'1984-09-26'
        WHEN 1406 THEN N'1985-09-15' WHEN 1407 THEN N'1986-09-05' WHEN 1408 THEN N'1987-08-25' WHEN 1409 THEN N'1988-08-13'
        WHEN 1410 THEN N'1989-08-02' WHEN 1411 THEN N'1990-07-23' WHEN 1412 THEN N'1991-07-12' WHEN 1413 THEN N'1992-07-01'
        WHEN 1414 THEN N'1993-06-21' WHEN 1415 THEN N'1994-06-10' WHEN 1416 THEN N'1995-05-30' WHEN 1417 THEN N'1996-05-18'
        WHEN 1418 THEN N'1997-05-07' WHEN 1419 THEN N'1998-04-27' WHEN 1420 THEN N'1999-04-17' WHEN 1421 THEN N'2000-04-06'
        WHEN 1422 THEN N'2001-03-26' WHEN 1423 THEN N'2002-03-15' WHEN 1424 THEN N'2003-03-04' WHEN 1425 THEN N'2004-02-21'
        WHEN 1426 THEN N'2005-02-10' WHEN 1427 THEN N'2006-01-31' WHEN 1428 THEN N'2007-01-20' WHEN 1429 THEN N'2008-01-10'
        WHEN 1430 THEN N'2008-12-29' WHEN 1431 THEN N'2009-12-18' WHEN 1432 THEN N'2010-12-07' WHEN 1433 THEN N'2011-11-26'
        WHEN 1434 THEN N'2012-11-15' WHEN 1435 THEN N'2013-11-04' WHEN 1436 THEN N'2014-10-25' WHEN 1437 THEN N'2015-10-14'
        WHEN 1438 THEN N'2016-10-02' WHEN 1439 THEN N'2017-09-21' WHEN 1440 THEN N'2018-09-11' WHEN 1441 THEN N'2019-08-31'
        WHEN 1442 THEN N'2020-08-20' WHEN 1443 THEN N'2021-08-09' WHEN 1444 THEN N'2022-07-30' WHEN 1445 THEN N'2023-07-19'
        WHEN 1446 THEN N'2024-07-07' WHEN 1447 THEN N'2025-06-26' WHEN 1448 THEN N'2026-06-16' WHEN 1449 THEN N'2027-06-06'
        WHEN 1450 THEN N'2028-05-25' WHEN 1451 THEN N'2029-05-14' WHEN 1452 THEN N'2030-05-03' WHEN 1453 THEN N'2031-04-23'
        WHEN 1454 THEN N'2032-04-11' WHEN 1455 THEN N'2033-04-01' WHEN 1456 THEN N'2034-03-21' WHEN 1457 THEN N'2035-03-11'
        WHEN 1458 THEN N'2036-02-28' WHEN 1459 THEN N'2037-02-16' WHEN 1460 THEN N'2038-02-05' WHEN 1461 THEN N'2039-01-26'
        WHEN 1462 THEN N'2040-01-15' WHEN 1463 THEN N'2041-01-04' WHEN 1464 THEN N'2041-12-24' WHEN 1465 THEN N'2042-12-14'
        WHEN 1466 THEN N'2043-12-03' WHEN 1467 THEN N'2044-11-21' WHEN 1468 THEN N'2045-11-10' WHEN 1469 THEN N'2046-10-31'
        WHEN 1470 THEN N'2047-10-20' WHEN 1471 THEN N'2048-10-09' WHEN 1472 THEN N'2049-09-28' WHEN 1473 THEN N'2050-09-17'
        WHEN 1474 THEN N'2051-09-06' WHEN 1475 THEN N'2052-08-26' WHEN 1476 THEN N'2053-08-15' WHEN 1477 THEN N'2054-08-05'
        WHEN 1478 THEN N'2055-07-25' WHEN 1479 THEN N'2056-07-14' WHEN 1480 THEN N'2057-07-03' WHEN 1481 THEN N'2058-06-22'
        WHEN 1482 THEN N'2059-06-11' WHEN 1483 THEN N'2060-05-31' WHEN 1484 THEN N'2061-05-20' WHEN 1485 THEN N'2062-05-10'
        WHEN 1486 THEN N'2063-04-30' WHEN 1487 THEN N'2064-04-18' WHEN 1488 THEN N'2065-04-07' WHEN 1489 THEN N'2066-03-27'
        WHEN 1490 THEN N'2067-03-16' WHEN 1491 THEN N'2068-03-05' WHEN 1492 THEN N'2069-02-23' WHEN 1493 THEN N'2070-02-12'
        WHEN 1494 THEN N'2071-02-01' WHEN 1495 THEN N'2072-01-21' WHEN 1496 THEN N'2073-01-09' WHEN 1497 THEN N'2073-12-30'
        WHEN 1498 THEN N'2074-12-19' WHEN 1499 THEN N'2075-12-09' WHEN 1500 THEN N'2076-11-27'
    END

    DECLARE @Days INT = @UqDay - 1;
    DECLARE @Month INT = 1;
    WHILE (@Month < @UqMonth)
    BEGIN
        SET @Days = @Days + [dbo].[fn_UmAlQura_DaysInMonth](@UqYear, @Month);
        SET @Month = @Month + 1;
    END
		
    RETURN DATEADD(DAY, @Days, @MuharramFirst);
END
