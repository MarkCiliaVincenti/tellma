CREATE FUNCTION [dbo].[fn_UmAlQura_DaysInMonth]
(
	@UqYear INT,
	@UqMonth INT
)
RETURNS INT
AS
BEGIN
	-- Maps each year to a 12 bit integer indicating which months are 29 days and which are 30
	DECLARE @Info INT = CASE @UqYear
        WHEN 1318 THEN 746  WHEN 1319 THEN 1769 WHEN 1320 THEN 3794 WHEN 1321 THEN 3748
        WHEN 1322 THEN 3402 WHEN 1323 THEN 2710 WHEN 1324 THEN 1334 WHEN 1325 THEN 2741
        WHEN 1326 THEN 3498 WHEN 1327 THEN 2980 WHEN 1328 THEN 2889 WHEN 1329 THEN 2707
        WHEN 1330 THEN 1323 WHEN 1331 THEN 2647 WHEN 1332 THEN 1206 WHEN 1333 THEN 2741
        WHEN 1334 THEN 1450 WHEN 1335 THEN 3413 WHEN 1336 THEN 3370 WHEN 1337 THEN 2646
        WHEN 1338 THEN 1198 WHEN 1339 THEN 2397 WHEN 1340 THEN 748  WHEN 1341 THEN 1749
        WHEN 1342 THEN 1706 WHEN 1343 THEN 1365 WHEN 1344 THEN 1195 WHEN 1345 THEN 2395
        WHEN 1346 THEN 698  WHEN 1347 THEN 1397 WHEN 1348 THEN 2994 WHEN 1349 THEN 1892
        WHEN 1350 THEN 1865 WHEN 1351 THEN 1621 WHEN 1352 THEN 683  WHEN 1353 THEN 1371
        WHEN 1354 THEN 2778 WHEN 1355 THEN 1748 WHEN 1356 THEN 3785 WHEN 1357 THEN 3474
        WHEN 1358 THEN 3365 WHEN 1359 THEN 2637 WHEN 1360 THEN 685  WHEN 1361 THEN 1389
        WHEN 1362 THEN 2922 WHEN 1363 THEN 2898 WHEN 1364 THEN 2725 WHEN 1365 THEN 2635
        WHEN 1366 THEN 1175 WHEN 1367 THEN 2359 WHEN 1368 THEN 694  WHEN 1369 THEN 1397
        WHEN 1370 THEN 3434 WHEN 1371 THEN 3410 WHEN 1372 THEN 2710 WHEN 1373 THEN 2349
        WHEN 1374 THEN 605  WHEN 1375 THEN 1245 WHEN 1376 THEN 2778 WHEN 1377 THEN 1492
        WHEN 1378 THEN 3497 WHEN 1379 THEN 3410 WHEN 1380 THEN 2730 WHEN 1381 THEN 1238
        WHEN 1382 THEN 2486 WHEN 1383 THEN 884  WHEN 1384 THEN 1897 WHEN 1385 THEN 1874
        WHEN 1386 THEN 1701 WHEN 1387 THEN 1355 WHEN 1388 THEN 2731 WHEN 1389 THEN 1370
        WHEN 1390 THEN 2773 WHEN 1391 THEN 3538 WHEN 1392 THEN 3492 WHEN 1393 THEN 3401
        WHEN 1394 THEN 2709 WHEN 1395 THEN 1325 WHEN 1396 THEN 2653 WHEN 1397 THEN 1370
        WHEN 1398 THEN 2773 WHEN 1399 THEN 1706 WHEN 1400 THEN 1685 WHEN 1401 THEN 1323
        WHEN 1402 THEN 2647 WHEN 1403 THEN 1198 WHEN 1404 THEN 2422 WHEN 1405 THEN 1388
        WHEN 1406 THEN 2901 WHEN 1407 THEN 2730 WHEN 1408 THEN 2645 WHEN 1409 THEN 1197
        WHEN 1410 THEN 2397 WHEN 1411 THEN 730  WHEN 1412 THEN 1497 WHEN 1413 THEN 3506
        WHEN 1414 THEN 2980 WHEN 1415 THEN 2890 WHEN 1416 THEN 2645 WHEN 1417 THEN 693
        WHEN 1418 THEN 1397 WHEN 1419 THEN 2922 WHEN 1420 THEN 3026 WHEN 1421 THEN 3012
        WHEN 1422 THEN 2953 WHEN 1423 THEN 2709 WHEN 1424 THEN 1325 WHEN 1425 THEN 1453
        WHEN 1426 THEN 2922 WHEN 1427 THEN 1748 WHEN 1428 THEN 3529 WHEN 1429 THEN 3474
        WHEN 1430 THEN 2726 WHEN 1431 THEN 2390 WHEN 1432 THEN 686  WHEN 1433 THEN 1389
        WHEN 1434 THEN 874  WHEN 1435 THEN 2901 WHEN 1436 THEN 2730 WHEN 1437 THEN 2381
        WHEN 1438 THEN 1181 WHEN 1439 THEN 2397 WHEN 1440 THEN 698  WHEN 1441 THEN 1461
        WHEN 1442 THEN 1450 WHEN 1443 THEN 3413 WHEN 1444 THEN 2714 WHEN 1445 THEN 2350
        WHEN 1446 THEN 622  WHEN 1447 THEN 1373 WHEN 1448 THEN 2778 WHEN 1449 THEN 1748
        WHEN 1450 THEN 1701 WHEN 1451 THEN 1355 WHEN 1452 THEN 2711 WHEN 1453 THEN 1358
        WHEN 1454 THEN 2734 WHEN 1455 THEN 1452 WHEN 1456 THEN 2985 WHEN 1457 THEN 3474
        WHEN 1458 THEN 2853 WHEN 1459 THEN 1611 WHEN 1460 THEN 3243 WHEN 1461 THEN 1370
        WHEN 1462 THEN 2901 WHEN 1463 THEN 1746 WHEN 1464 THEN 3749 WHEN 1465 THEN 3658
        WHEN 1466 THEN 2709 WHEN 1467 THEN 1325 WHEN 1468 THEN 2733 WHEN 1469 THEN 876
        WHEN 1470 THEN 1881 WHEN 1471 THEN 1746 WHEN 1472 THEN 1685 WHEN 1473 THEN 1325
        WHEN 1474 THEN 2651 WHEN 1475 THEN 1210 WHEN 1476 THEN 2490 WHEN 1477 THEN 948
        WHEN 1478 THEN 2921 WHEN 1479 THEN 2898 WHEN 1480 THEN 2726 WHEN 1481 THEN 1206
        WHEN 1482 THEN 2413 WHEN 1483 THEN 748  WHEN 1484 THEN 1753 WHEN 1485 THEN 3762
        WHEN 1486 THEN 3412 WHEN 1487 THEN 3370 WHEN 1488 THEN 2646 WHEN 1489 THEN 1198
        WHEN 1490 THEN 2413 WHEN 1491 THEN 3434 WHEN 1492 THEN 2900 WHEN 1493 THEN 2857
        WHEN 1494 THEN 2707 WHEN 1495 THEN 1323 WHEN 1496 THEN 2647 WHEN 1497 THEN 1334
        WHEN 1498 THEN 2741 WHEN 1499 THEN 1706 WHEN 1500 THEN 3731
    END
		
	-- Why AND the info with a bit mask that matches the supplied month
	-- E.g. for month 2 (Safar) we use 000000000010
	RETURN CASE WHEN (@Info & Power(2, @UqMonth - 1)) > 0 THEN 30 ELSE 29 END
END
