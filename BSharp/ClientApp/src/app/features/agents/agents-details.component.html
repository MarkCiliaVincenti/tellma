<b-details collection="Agent" [definition]="definitionId" [createFunc]="create" [expand]="expand" [mode]="mode"
  [idString]="idString" [masterCrumb]=masterCrumb [detailsCrumb]="detailsCrumb" [documentTemplate]="document" [actions]="[
            { template: activate, action: onActivate, showAction: showActivate, canAction: canActivateDeactivateItem, actionTooltip: activateDeactivateTooltip },
            { template: deactivate, action: onDeactivate, showAction: showDeactivate, canAction: canActivateDeactivateItem, actionTooltip: activateDeactivateTooltip }
           ]">

</b-details>

<!-- Details Crumb -->
<ng-template #detailsCrumb let-model="model">
  <span>{{ getMultilingualValue(model, 'Name', ws) }}</span>
</ng-template>

<!-- Edit/View Template -->
<ng-template #document let-model="model" let-isEdit="isEdit">

  <!-- Header Name -->
  <b-form-group class="col-12 col-md-8 mb-2 mb-sm-4 b-h2" [serverErrors]="model?.serverErrors?.Name">
    <h2 class="font-weight-normal" *ngIf="!isEdit">{{ getMultilingualValue(model, 'Name', ws) }}</h2>

    <b-text-editor *ngIf="isEdit && ws.isPrimaryLanguage" [focusIf]="!model.Id" [(ngModel)]="model.Name"
      [ngModelOptions]="{ updateOn: 'blur' }" [placeholder]="('Name' | translate) + ws.primaryPostfix + '...'" required>
    </b-text-editor>

    <b-text-editor *ngIf="isEdit && ws.isSecondaryLanguage" [focusIf]="!model.Id" [(ngModel)]="model.Name2"
      [ngModelOptions]="{ updateOn: 'blur' }" [placeholder]="('Name' | translate) + ws.secondaryPostfix + '...'">
    </b-text-editor>

    <b-text-editor *ngIf="isEdit && ws.isTernaryLanguage" [focusIf]="!model.Id" [(ngModel)]="model.Name3"
      [ngModelOptions]="{ updateOn: 'blur' }" [placeholder]="('Name' | translate) + ws.ternaryPostfix + '...'">
    </b-text-editor>
  </b-form-group>

  <!-- Image -->
  <div class="col-12 col-md-4 b-details-image-container">
    <b-restricted [metadata]="model?.EntityMetadata?.ImageId">
      <div class="border">
        <b-image *ngIf="!!model" [src]="model.Id ? 'agents/' + definitionId + '/' + model.Id + '/image' : null"
          [imageId]="model?.ImageId" [(ngModel)]="model.Image" [isEdit]="isEdit"></b-image>
      </div>
    </b-restricted>
  </div>

  <!-- Name -->
  <b-form-group class="b-form-group" *ngIf="!ws.isPrimaryLanguage" [label]="('Name' | translate) + ws.primaryPostfix"
    [serverErrors]="model?.serverErrors?.Name">
    <div *ngIf="!isEdit">{{ model?.Name }}</div>
    <b-text-editor *ngIf="isEdit" [(ngModel)]="model.Name" [ngModelOptions]="{ updateOn: 'blur' }" required>
    </b-text-editor>
  </b-form-group>

  <!-- Name2 -->
  <b-form-group class="b-form-group" *ngIf="!ws.isSecondaryLanguage && ws.settings.SecondaryLanguageId"
    [label]="('Name' | translate) + ws.secondaryPostfix" [serverErrors]="model?.serverErrors?.Name2">
    <div *ngIf="!isEdit">{{ model?.Name2 }}</div>
    <b-text-editor *ngIf="isEdit" [(ngModel)]="model.Name2" [ngModelOptions]="{ updateOn: 'blur' }"></b-text-editor>
  </b-form-group>

  <!-- Name3 -->
  <b-form-group class="b-form-group" *ngIf="!ws.isTernaryLanguage && ws.settings.TernaryLanguageId"
    [label]="('Name' | translate) + ws.ternaryPostfix" [serverErrors]="model?.serverErrors?.Name3">
    <div *ngIf="!isEdit">{{ model?.Name3 }}</div>
    <b-text-editor *ngIf="isEdit" [(ngModel)]="model.Name3" [ngModelOptions]="{ updateOn: 'blur' }"></b-text-editor>
  </b-form-group>

  <!-- Code -->
  <b-form-group class="b-form-group" [label]="'Code' | translate" [serverErrors]="model?.serverErrors?.Code">
    <div *ngIf="!isEdit">{{ model?.Code }}</div>
    <b-text-editor *ngIf="isEdit" [(ngModel)]="model.Code" [ngModelOptions]="{ updateOn: 'blur' }"></b-text-editor>
  </b-form-group>

  <!-- Tax Identification Number -->
  <b-form-group class="b-form-group" *ngIf="!!p.TaxIdentificationNumber" [label]="p['TaxIdentificationNumber'].label()"
    [serverErrors]="model?.serverErrors?.TaxIdentificationNumber">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.TaxIdentificationNumber">
      <div>{{ model?.TaxIdentificationNumber }}</div>
    </b-restricted>
    <b-text-editor *ngIf="isEdit" [(ngModel)]="model.TaxIdentificationNumber" [ngModelOptions]="{ updateOn: 'blur' }"
      [required]="d['TaxIdentificationNumberVisibility'] === 'Required'">
    </b-text-editor>
  </b-form-group>

  <!-- Operating Segment -->
  <b-form-group class="b-form-group" *ngIf="!!p.OperatingSegmentId" [label]="p['OperatingSegment'].label()"
    [serverErrors]="model?.serverErrors?.OperatingSegmentId">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.OperatingSegment">
      <b-view-link *ngIf="!isEdit" link="../../../responsibility-centers" [itemId]="model?.OperatingSegmentId">
        <b-auto-cell collection="Agent" [definition]="definitionId" [entity]="model" path="OperatingSegment">
        </b-auto-cell>
      </b-view-link>
    </b-restricted>
    <b-responsibility-centers-picker *ngIf="isEdit" [(ngModel)]="model.OperatingSegmentId"
      filter="IsOperatingSegment eq true">
    </b-responsibility-centers-picker>
  </b-form-group>

  <!-- Start Date -->
  <b-form-group class="b-form-group" *ngIf="!!p.StartDate" [label]="p['StartDate'].label()"
    [serverErrors]="model?.serverErrors?.StartDate">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.StartDate">
      <b-auto-cell collection="Agent" [definition]="definitionId" [entity]="model" path="StartDate">
      </b-auto-cell>
    </b-restricted>
    <b-date-picker *ngIf="isEdit" [(ngModel)]="model.StartDate" [ngModelOptions]="{ updateOn: 'blur' }"
      [required]="d['StartDateVisibility'] === 'Required'">
    </b-date-picker>
  </b-form-group>

  <!-- Basic Salary -->
  <b-form-group class="b-form-group" *ngIf="!!p.BasicSalary" [label]="p['BasicSalary'].label()"
    [serverErrors]="model?.serverErrors?.BasicSalary">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.BasicSalary">
      <b-auto-cell collection="Agent" [definition]="definitionId" [entity]="model" path="BasicSalary">
      </b-auto-cell>
    </b-restricted>
    <b-decimal-editor *ngIf="isEdit" [(ngModel)]="model.BasicSalary" [ngModelOptions]="{ updateOn: 'blur' }"
      [required]="d['BasicSalaryVisibility'] === 'Required'">
    </b-decimal-editor>
  </b-form-group>

  <!-- Transportation Allowance -->
  <b-form-group class="b-form-group" *ngIf="!!p.TransportationAllowance" [label]="p['TransportationAllowance'].label()"
    [serverErrors]="model?.serverErrors?.TransportationAllowance">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.TransportationAllowance">
      <b-auto-cell collection="Agent" [definition]="definitionId" [entity]="model" path="TransportationAllowance">
      </b-auto-cell>
    </b-restricted>
    <b-decimal-editor *ngIf="isEdit" [(ngModel)]="model.TransportationAllowance" [ngModelOptions]="{ updateOn: 'blur' }"
      [required]="d['TransportationAllowanceVisibility'] === 'Required'">
    </b-decimal-editor>
  </b-form-group>

  <!-- Overtime Rate -->
  <b-form-group class="b-form-group" *ngIf="!!p.OvertimeRate" [label]="p['OvertimeRate'].label()"
    [serverErrors]="model?.serverErrors?.OvertimeRate">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.OvertimeRate">
      <b-auto-cell collection="Agent" [definition]="definitionId" [entity]="model" path="OvertimeRate">
      </b-auto-cell>
    </b-restricted>
    <b-decimal-editor *ngIf="isEdit" [(ngModel)]="model.OvertimeRate" [ngModelOptions]="{ updateOn: 'blur' }"
      [required]="d['OvertimeRateVisibility'] === 'Required'">
    </b-decimal-editor>
  </b-form-group>

  <!-- Bank Account Number -->
  <b-form-group class="b-form-group" *ngIf="!!p.BankAccountNumber" [label]="p['BankAccountNumber'].label()"
    [serverErrors]="model?.serverErrors?.BankAccountNumber">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.BankAccountNumber">
      <div>{{ model?.BankAccountNumber }}</div>
    </b-restricted>
    <b-text-editor *ngIf="isEdit" [(ngModel)]="model.BankAccountNumber" [ngModelOptions]="{ updateOn: 'blur' }"
      [required]="d['BankAccountNumberVisibility'] === 'Required'">
    </b-text-editor>
  </b-form-group>

  
  <!-- User -->
  <b-form-group class="b-form-group" *ngIf="!!p.UserId" [label]="p['User'].label()"
    [serverErrors]="model?.serverErrors?.UserId">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.User">
      <b-view-link *ngIf="!isEdit" link="../../../users" [itemId]="model?.UserId">
        <b-auto-cell collection="Agent" [definition]="definitionId" [entity]="model" path="User">
        </b-auto-cell>
      </b-view-link>
    </b-restricted>
    <b-users-picker *ngIf="isEdit" [(ngModel)]="model.UserId">
    </b-users-picker>
  </b-form-group>

  <!-- Is Related -->
  <b-form-group class="b-form-group" [label]="'Agent_IsRelated' | translate"
    [serverErrors]="model?.serverErrors?.IsRelated">
    <b-restricted *ngIf="!isEdit" [metadata]="model?.EntityMetadata?.IsRelated">
      {{ (model?.IsRelated ? 'Yes' : 'No') | translate }}
    </b-restricted>
    <div *ngIf="isEdit" class="custom-control custom-checkbox b-labelless-checkbox">
      <input type="checkbox" class="custom-control-input" [(ngModel)]="model.IsRelated" id="isRelated">
      <label class="custom-control-label b-pointer" for="isRelated">&zwnj;</label>
    </div>
  </b-form-group>

  <!-- Is Active -->
  <b-form-group class="b-form-group" [label]="'IsActive' | translate" *ngIf="!isEdit">
    <div>{{ (!model ? '' : model.IsActive ? 'Active' : 'Inactive') | translate }}</div>
  </b-form-group>
</ng-template>

<!-- Actions -->
<ng-template #activate> {{ 'Activate' | translate }} </ng-template>
<ng-template #deactivate> {{ 'Deactivate' | translate }} </ng-template>